(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entities = Object.create(null);
exports.createEntity = (id, extension) => {
    if (entities[id] != null) {
        throw new Error("Entity already exists");
    }
    entities[id] =
        extension != null ? Object.assign({}, extension, { id }) : { id };
    return entities[id];
};
exports.extendEntity = (entity, extension) => {
    return Object.assign(entity, extension);
};
function isTangibleEntity(point) {
    return "location" in point;
}
exports.isTangibleEntity = isTangibleEntity;
},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const getImageFromId = (id) => document.getElementById(id);
exports.entities = {
    player: {
        id: "player",
        sprite: [
            {
                image: getImageFromId("resource-player0"),
                tileSize: 16,
                x: 2,
                y: 3,
                width: 1,
                height: 1
            },
            {
                image: getImageFromId("resource-player1"),
                tileSize: 16,
                x: 2,
                y: 3,
                width: 1,
                height: 1
            }
        ]
    },
    // Better way to handle tiles/tilesets?
    tiles: {
        grass: {
            id: "tiles/grass",
            sprite: {
                image: getImageFromId("resource-floor"),
                tileSize: 16,
                x: 8,
                y: 7,
                width: 1,
                height: 1
            },
            collision: false
        },
        wall: {
            id: "tiles/wall",
            sprite: {
                image: getImageFromId("resource-wall"),
                tileSize: 16,
                x: 3,
                y: 3,
                width: 1,
                height: 1
            },
            collision: true
        }
    }
};
exports.map = [
    [
        "################",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#....######....#",
        "#....#....#....#",
        "#....#....#....#",
        "#....#....#....#",
        "#....##.###....#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "################"
    ],
    [
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "       @        ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                "
    ]
];
exports.tiles = {
    "#": exports.entities.tiles.wall.id,
    ".": exports.entities.tiles.grass.id,
    "@": exports.entities.player.id
};
},{}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const config = require("./game.config");
const scene_1 = require("./scene");
const sprite_1 = require("./sprite");
const entity_1 = require("./entity");
exports.scene = scene_1.createScene();
const playerCamera = {
    scene: exports.scene,
    canvas: null,
    tileSize: 48,
    x: 0,
    y: 0,
    width: 12,
    height: 12,
    focus: {
        width: 6,
        height: 6
    }
};
exports.createPlayerCamera = (canvas) => {
    playerCamera.canvas = canvas;
    exports.centerCamera();
    return playerCamera;
};
exports.centerCamera = () => {
    if (player) {
        const cameraMarginX = Math.floor((playerCamera.width - playerCamera.focus.width) / 2);
        const cameraMarginY = Math.floor((playerCamera.height - playerCamera.focus.height) / 2);
        if (player.location.x >=
            playerCamera.focus.width + playerCamera.x + cameraMarginX) {
            playerCamera.x =
                player.location.x + 1 - playerCamera.focus.width - cameraMarginX;
        }
        if (player.location.y >=
            playerCamera.focus.height + playerCamera.y + cameraMarginY) {
            playerCamera.y =
                player.location.y + 1 - playerCamera.focus.height - cameraMarginY;
        }
        if (player.location.x < playerCamera.x + cameraMarginX) {
            playerCamera.x = player.location.x - cameraMarginX;
        }
        if (player.location.y < playerCamera.y + cameraMarginY) {
            playerCamera.y = player.location.y - cameraMarginY;
        }
    }
    if (playerCamera.canvas) {
        playerCamera.width = Math.ceil(playerCamera.canvas.width / playerCamera.tileSize);
        playerCamera.height = Math.ceil(playerCamera.canvas.height / playerCamera.tileSize);
    }
};
const tileEntities = ((tiles) => {
    const entities = {};
    for (const name in tiles) {
        const entity = sprite_1.createSprite(tiles[name]);
        if (isCollidable(tiles[name])) {
            entity.collision = tiles[name].collision;
        }
        entities[entity.id] = entity;
    }
    return entities;
})(config.entities.tiles);
const addTile = (name, location) => {
    return entity_1.extendEntity(scene_1.addChild(exports.scene.root, tileEntities[name]).entity, {
        location
    });
};
tileEntities.player = sprite_1.createSprite(config.entities.player);
let player = null;
function isCollidable(entity) {
    return "collision" in entity;
}
const collisionMap = [];
for (let z = 0; z < config.map.length; z++) {
    for (let y = 0; y < config.map[z].length; y++) {
        for (let x = 0; x < config.map[z][y].length; x++) {
            const name = config.tiles[config.map[z][y][x]];
            const entity = addTile(name, {
                x,
                y,
                z
            });
            if (isCollidable(entity)) {
                if (!collisionMap[x]) {
                    collisionMap[x] = [];
                }
                collisionMap[x][y] = entity.collision;
            }
            if (name === "player") {
                player = entity;
            }
        }
    }
}
playerCamera.x = Math.floor(player.location.x - playerCamera.width / 2);
playerCamera.y = Math.floor(player.location.y - playerCamera.height / 2);
var KeyMap;
(function (KeyMap) {
    KeyMap[KeyMap["left"] = 37] = "left";
    KeyMap[KeyMap["up"] = 38] = "up";
    KeyMap[KeyMap["right"] = 39] = "right";
    KeyMap[KeyMap["down"] = 40] = "down";
})(KeyMap = exports.KeyMap || (exports.KeyMap = {}));
exports.handleInput = (keysPressed) => {
    let turnTaken = false;
    let vecMovement = [0, 0];
    const collisionAt = (relX, relY) => {
        const newX = player.location.x + relX;
        const newY = player.location.y + relY;
        return collisionMap[newX] && collisionMap[newX][newY];
    };
    if (keysPressed[KeyMap.left] && !collisionAt(-1, 0))
        vecMovement[0]--;
    if (keysPressed[KeyMap.up] && !collisionAt(0, -1))
        vecMovement[1]--;
    if (keysPressed[KeyMap.right] && !collisionAt(1, 0))
        vecMovement[0]++;
    if (keysPressed[KeyMap.down] && !collisionAt(0, 1))
        vecMovement[1]++;
    // No diagonal movement
    if (Math.abs(vecMovement[0]) + Math.abs(vecMovement[1]) === 1) {
        player.location.x += vecMovement[0];
        player.location.y += vecMovement[1];
        turnTaken = true;
    }
    return turnTaken;
};
exports.preRender = ({ camera, animState }) => {
    exports.centerCamera();
};
},{"./entity":1,"./game.config":2,"./scene":7,"./sprite":8}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isOverlap = ({ x: x1, y: y1, width: w1 = 0, height: h1 = 0 }, { x: x2, y: y2, width: w2 = 0, height: h2 = 0 }) => x1 <= x2 + w2 && x1 + w1 >= x2 && y1 <= y2 + h2 && y1 + h1 >= y2;
},{}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const renderer_1 = require("./renderer");
const game_1 = require("./game");
// Setup
const $canvas = document.createElement("canvas");
$canvas.width = innerWidth;
$canvas.height = innerHeight;
$canvas.style.position = "absolute";
$canvas.style.top = "0";
$canvas.style.left = "0";
$canvas.style.margin = "0";
document.body.appendChild($canvas);
// Input
// TODO: clean up buffering code, optimize?
const keysDown = Object.create(null);
const keysUp = Object.create(null);
window.addEventListener("keydown", e => {
    if (e.keyCode in game_1.KeyMap) {
        keysDown[e.keyCode] = true;
        e.preventDefault();
    }
});
window.addEventListener("keyup", e => {
    if (e.keyCode in game_1.KeyMap) {
        keysUp[e.keyCode] = true;
        e.preventDefault();
    }
});
let prevInput = 0;
const input = () => {
    const delta = time.curTime - prevInput;
    let keyPressed = false;
    for (let keyCode in game_1.KeyMap) {
        if (!isNaN(Number(keyCode))) {
            if (delta < time.animResolution) {
                keysDown[keyCode] = keysUp[keyCode] ? false : keysDown[keyCode];
                keysUp[keyCode] = false;
                keyPressed = false;
            }
            else {
                keyPressed = keysDown[keyCode] || keyPressed;
            }
        }
    }
    if (keyPressed) {
        const turnTaken = game_1.handleInput(Object.assign(Object.create(null), keysDown));
        if (turnTaken)
            prevInput = time.curTime;
    }
};
const stats = new Stats();
document.body.appendChild(stats.dom);
// Render Loop
const time = {
    start: 0,
    prevTime: 0,
    curTime: performance.now(),
    animCounter: 0,
    animState: 0,
    animResolution: 500
};
const camera = game_1.createPlayerCamera($canvas);
const loop = () => {
    if (time.start === 0)
        time.start = performance.now();
    time.curTime = performance.now();
    const deltaTime = time.curTime - time.prevTime;
    time.animCounter += deltaTime;
    time.animState = Math.floor(time.animCounter / time.animResolution);
    input();
    if (time.prevTime !== 0) {
        $canvas.width = innerWidth;
        $canvas.height = innerHeight;
        const ctx = $canvas.getContext("2d");
        if (ctx) {
            game_1.preRender({ camera, animState: time.animState });
            renderer_1.render({
                ctx,
                camera,
                animState: time.animState
            });
        }
    }
    stats.update();
    requestAnimationFrame(loop);
    time.prevTime = time.curTime;
};
loop();
},{"./game":3,"./renderer":6}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const sprite_1 = require("./sprite");
const geometry_1 = require("./geometry");
const entity_1 = require("./entity");
const drawSprite = (ctx, sprite, tileSize, dstX, dstY) => {
    ctx.drawImage(sprite.image, sprite.x * sprite.tileSize, sprite.y * sprite.tileSize, sprite.width * sprite.tileSize, sprite.height * sprite.tileSize, dstX * tileSize, dstY * tileSize, sprite.width * tileSize, sprite.height * tileSize);
};
const drawEntity = (ctx, entity, animation, tileSize, dstX, dstY) => {
    const sprite = Array.isArray(entity.sprite)
        ? entity.sprite[animation % entity.sprite.length]
        : entity.sprite;
    drawSprite(ctx, sprite, tileSize, dstX, dstY);
};
exports.render = ({ ctx, camera, animState }) => {
    ctx.imageSmoothingEnabled = false;
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, camera.canvas.width, camera.canvas.height);
    const sprites = Object.create(null);
    for (const node of camera.scene.nodes) {
        const entity = node.entity;
        if (sprite_1.isSpriteEntity(entity) &&
            entity_1.isTangibleEntity(entity) &&
            geometry_1.isOverlap(camera, entity.location)) {
            sprites[entity.location.z] = sprites[entity.location.z] || [];
            sprites[entity.location.z].push(entity);
        }
    }
    for (const z in sprites) {
        for (const sprite of sprites[z]) {
            drawEntity(ctx, sprite, animState, camera.tileSize, sprite.location.x - camera.x, sprite.location.y - camera.y);
        }
    }
};
},{"./entity":1,"./geometry":4,"./sprite":8}],7:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entity_1 = require("./entity");
exports.createScene = () => {
    const scene = {
        nodes: [],
        root: {
            scene: null,
            parent: null,
            children: [],
            entity: entity_1.createEntity("scene")
        }
    };
    scene.root.scene = scene;
    return scene;
};
exports.addChild = (node, entity) => {
    const child = {
        scene: node.scene,
        parent: node,
        children: [],
        entity: Object.assign(Object.create(null), entity)
    };
    node.children.push(child);
    node.scene.nodes.push(child);
    return child;
};
exports.removeChild = (node) => {
    if (node.parent != null) {
        const parentIndex = node.parent.children.indexOf(node);
        node.parent.children.splice(parentIndex, 1);
        const sceneIndex = node.scene.nodes.indexOf(node);
        node.scene.nodes.splice(sceneIndex, 1);
    }
};
},{"./entity":1}],8:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entity_1 = require("./entity");
function isSpriteEntity(entity) {
    return "sprite" in entity;
}
exports.isSpriteEntity = isSpriteEntity;
exports.createSprite = ({ id, sprite }) => {
    let spriteCopy = null;
    if (Array.isArray(sprite)) {
        spriteCopy = sprite.slice();
        for (const i in sprite) {
            sprite[i] = Object.assign(Object.create(null), sprite[i]);
        }
    }
    else {
        spriteCopy = Object.assign(Object.create(null), sprite);
    }
    return entity_1.createEntity(id, {
        sprite: spriteCopy
    });
};
},{"./entity":1}]},{},[5])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZW50aXR5LnRzIiwic3JjL2dhbWUuY29uZmlnLnRzIiwic3JjL2dhbWUudHMiLCJzcmMvZ2VvbWV0cnkudHMiLCJzcmMvaW5kZXgudHMiLCJzcmMvcmVuZGVyZXIudHMiLCJzcmMvc2NlbmUudHMiLCJzcmMvc3ByaXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNFQSxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBTXhCLFFBQUEsWUFBWSxHQUFHLENBQ3pCLEVBQVEsRUFDUixTQUFxQjtJQUVyQixFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELFFBQVEsQ0FBQyxFQUFFLENBQUM7UUFDVCxTQUFTLElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUVyRSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBNEIsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFVyxRQUFBLFlBQVksR0FBRyxDQUN6QixNQUFnQyxFQUNoQyxTQUFxQjtJQUVyQixNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUdyQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDO0FBT0YsMEJBQ0csS0FBOEI7SUFFOUIsTUFBTSxDQUFDLFVBQVUsSUFBSSxLQUFLLENBQUM7QUFDOUIsQ0FBQztBQUpELDRDQUlDOzs7O0FDekNELE1BQU0sY0FBYyxHQUFHLENBQUMsRUFBVSxLQUMvQixRQUFRLENBQUMsY0FBYyxDQUFDLEVBQUUs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QyxDQUFDLEVBQUUsQ0FBQztJQUN0RSxFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRXJFLHVCQUF1QjtJQUN2QixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXBDLFNBQVMsR0FBRyxJQUFJLENBQUM7SUFDcEIsQ0FBQztJQUVELE1BQU0sQ0FBQyxTQUFTLENBQUM7QUFDcEIsQ0FBQyxDQUFDO0FBRVcsUUFBQSxTQUFTLEdBQUcsQ0FBQyxFQUN2QixNQUFNLEVBQ04sU0FBUyxFQUlYO0lBQ0Usb0JBQVksRUFBRSxDQUFDO0FBQ2xCLENBQUMsQ0FBQzs7OztBQ2xLVyxRQUFBLFNBQVMsR0FBRyxDQUN0QixFQUNHLENBQUMsRUFBRSxFQUFFLEVBQ0wsQ0FBQyxFQUFFLEVBQUUsRUFDTCxLQUFLLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFDYixNQUFNLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFDMkMsRUFDNUQsRUFDRyxDQUFDLEVBQUUsRUFBRSxFQUNMLENBQUMsRUFBRSxFQUFFLEVBQ0wsS0FBSyxFQUFFLEVBQUUsR0FBRyxDQUFDLEVBQ2IsTUFBTSxFQUFFLEVBQUUsR0FBRyxDQUFDLEVBQzJDLEtBQzFELEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxJ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LE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN6QixVQUFVLEdBQUcsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzVCLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDdEIsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRSxDQUFDO0lBQ0osQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ0wsVUFBVSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsTUFBTSxDQUFDLHFCQUFZLENBQUMsRUFBRSxFQUFFO1FBQ3JCLE1BQU0sRUFBRSxVQUFVO0tBQ3BCLENBQXVCLENBQUM7QUFDNUIsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7IFBvaW50M0QgfSBmcm9tIFwiLi9nZW9tZXRyeVwiO1xyXG5cclxuY29uc3QgZW50aXRpZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5cclxuZXhwb3J0IHR5cGUgRW50aXR5PFR5cGUgZXh0ZW5kcyBTdHJpbmcsIEV4dGVuc2lvbj4gPSB7XHJcbiAgIGlkOiBUeXBlO1xyXG59ICYgRXh0ZW5zaW9uO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUVudGl0eSA9IDxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBpZDogVHlwZSxcclxuICAgZXh0ZW5zaW9uPzogRXh0ZW5zaW9uXHJcbikgPT4ge1xyXG4gICBpZiAoZW50aXRpZXNbaWRdICE9IG51bGwpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW50aXR5IGFscmVhZHkgZXhpc3RzXCIpO1xyXG4gICB9XHJcblxyXG4gICBlbnRpdGllc1tpZF0gPVxyXG4gICAgICBleHRlbnNpb24gIT0gbnVsbCA/IE9iamVjdC5hc3NpZ24oe30sIGV4dGVuc2lvbiwgeyBpZCB9KSA6IHsgaWQgfTtcclxuXHJcbiAgIHJldHVybiBlbnRpdGllc1tpZF0gYXMgRW50aXR5PFR5cGUsIEV4dGVuc2lvbj47XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZXh0ZW5kRW50aXR5ID0gPFR5cGUgZXh0ZW5kcyBzdHJpbmcsIEV4dGVuc2lvbjEsIEV4dGVuc2lvbjI+KFxyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24xPixcclxuICAgZXh0ZW5zaW9uOiBFeHRlbnNpb24yXHJcbikgPT4ge1xyXG4gICByZXR1cm4gT2JqZWN0LmFzc2lnbihlbnRpdHksIGV4dGVuc2lvbikgYXMgRW50aXR5PFxyXG4gICAgICBUeXBlLFxyXG4gICAgICBFeHRlbnNpb24xICYgRXh0ZW5zaW9uMlxyXG4gICA+O1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgVGFuZ2libGVFbnRpdHk8XHJcbiAgIFR5cGUgZXh0ZW5kcyBzdHJpbmcsXHJcbiAgIEV4dGVuc2lvbiBleHRlbmRzIHsgbG9jYXRpb246IFBvaW50M0QgfVxyXG4+ID0gRW50aXR5PFR5cGUsIEV4dGVuc2lvbj47XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUYW5naWJsZUVudGl0eTxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBwb2ludDogRW50aXR5PFR5cGUsIEV4dGVuc2lvbj5cclxuKTogcG9pbnQgaXMgVGFuZ2libGVFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uICYgeyBsb2NhdGlvbjogUG9pbnQzRCB9PiB7XHJcbiAgIHJldHVybiBcImxvY2F0aW9uXCIgaW4gcG9pbnQ7XHJcbn1cclxuIiwiY29uc3QgZ2V0SW1hZ2VGcm9tSWQgPSAoaWQ6IHN0cmluZyk6IEhUTUxJbWFnZUVsZW1lbnQgPT5cclxuICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XHJcblxyXG5leHBvcnQgY29uc3QgZW50aXRpZXMgPSB7XHJcbiAgIHBsYXllcjoge1xyXG4gICAgICBpZDogXCJwbGF5ZXJcIiBhcyBcInBsYXllclwiLFxyXG4gICAgICBzcHJpdGU6IFtcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBpbWFnZTogZ2V0SW1hZ2VGcm9tSWQoXCJyZXNvdXJjZS1wbGF5ZXIwXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDIsXHJcbiAgICAgICAgICAgIHk6IDMsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfSxcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBpbWFnZTogZ2V0SW1hZ2VGcm9tSWQoXCJyZXNvdXJjZS1wbGF5ZXIxXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDIsXHJcbiAgICAgICAgICAgIHk6IDMsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgIH0sXHJcbiAgIC8vIEJldHRlciB3YXkgdG8gaGFuZGxlIHRpbGVzL3RpbGVzZXRzP1xyXG4gICB0aWxlczoge1xyXG4gICAgICBncmFzczoge1xyXG4gICAgICAgICBpZDogXCJ0aWxlcy9ncmFzc1wiIGFzIFwidGlsZXMvZ3Jhc3NcIixcclxuICAgICAgICAgc3ByaXRlOiB7XHJcbiAgICAgICAgICAgIGltYWdlOiBnZXRJbWFnZUZyb21JZChcInJlc291cmNlLWZsb29yXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDgsXHJcbiAgICAgICAgICAgIHk6IDcsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfSxcclxuICAgICAgICAgY29sbGlzaW9uOiBmYWxzZVxyXG4gICAgICB9LFxyXG4gICAgICB3YWxsOiB7XHJcbiAgICAgICAgIGlkOiBcInRpbGVzL3dhbGxcIiBhcyBcInRpbGVzL3dhbGxcIixcclxuICAgICAgICAgc3ByaXRlOiB7XHJcbiAgICAgICAgICAgIGltYWdlOiBnZXRJbWFnZUZyb21JZChcInJlc291cmNlLXdhbGxcIiksXHJcbiAgICAgICAgICAgIHRpbGVTaXplOiAxNixcclxuICAgICAgICAgICAgeDogMyxcclxuICAgICAgICAgICAgeTogMyxcclxuICAgICAgICAgICAgd2lkdGg6IDEsXHJcbiAgICAgICAgICAgIGhlaWdodDogMVxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICBjb2xsaXNpb246IHRydWVcclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbWFwID0gW1xyXG4gICBbXHJcbiAgICAgIFwiIyMjIyMjIyMjIyMjIyMjI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4uLi4uLi4uLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4jIyMjIyMuLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uIy4uLi4jLi4uLiNcIixcclxuICAgICAgXCIjLi4uLiMuLi4uIy4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4jLi4uLiMuLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uIyMuIyMjLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4uLi4uLi4uLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIyMjIyMjIyMjIyMjIyMjI1wiXHJcbiAgIF0sXHJcbiAgIFtcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICBAICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCJcclxuICAgXVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHRpbGVzOiB7XHJcbiAgIFtrZXk6IHN0cmluZ106IHN0cmluZztcclxufSA9IHtcclxuICAgXCIjXCI6IGVudGl0aWVzLnRpbGVzLndhbGwuaWQsXHJcbiAgIFwiLlwiOiBlbnRpdGllcy50aWxlcy5ncmFzcy5pZCxcclxuICAgXCJAXCI6IGVudGl0aWVzLnBsYXllci5pZFxyXG59O1xyXG4iLCJpbXBvcnQgKiBhcyBjb25maWcgZnJvbSBcIi4vZ2FtZS5jb25maWdcIjtcclxuaW1wb3J0IHsgY3JlYXRlU2NlbmUsIGFkZENoaWxkIH0gZnJvbSBcIi4vc2NlbmVcIjtcclxuaW1wb3J0IHsgY3JlYXRlU3ByaXRlLCBTcHJpdGVFbnRpdHksIFNwcml0ZSB9IGZyb20gXCIuL3Nwcml0ZVwiO1xyXG5pbXBvcnQgeyBQb2ludDNEIH0gZnJvbSBcIi4vZ2VvbWV0cnlcIjtcclxuaW1wb3J0IHsgZXh0ZW5kRW50aXR5LCBFbnRpdHkgfSBmcm9tIFwiLi9lbnRpdHlcIjtcclxuaW1wb3J0IHsgQ2FtZXJhIH0gZnJvbSBcIi4vcmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBzY2VuZSA9IGNyZWF0ZVNjZW5lKCk7XHJcblxyXG5jb25zdCBwbGF5ZXJDYW1lcmEgPSB7XHJcbiAgIHNjZW5lOiBzY2VuZSxcclxuICAgY2FudmFzOiBudWxsIGFzIEhUTUxDYW52YXNFbGVtZW50IHwgbnVsbCxcclxuICAgdGlsZVNpemU6IDQ4LFxyXG4gICB4OiAwLFxyXG4gICB5OiAwLFxyXG4gICB3aWR0aDogMTIsXHJcbiAgIGhlaWdodDogMTIsXHJcbiAgIGZvY3VzOiB7XHJcbiAgICAgIHdpZHRoOiA2LFxyXG4gICAgICBoZWlnaHQ6IDZcclxuICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBsYXllckNhbWVyYSA9IChjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSA9PiB7XHJcbiAgIHBsYXllckNhbWVyYS5jYW52YXMgPSBjYW52YXM7XHJcblxyXG4gICBjZW50ZXJDYW1lcmEoKTtcclxuXHJcbiAgIHJldHVybiBwbGF5ZXJDYW1lcmE7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY2VudGVyQ2FtZXJhID0gKCkgPT4ge1xyXG4gICBpZiAocGxheWVyKSB7XHJcbiAgICAgIGNvbnN0IGNhbWVyYU1hcmdpblggPSBNYXRoLmZsb29yKFxyXG4gICAgICAgICAocGxheWVyQ2FtZXJhLndpZHRoIC0gcGxheWVyQ2FtZXJhLmZvY3VzLndpZHRoKSAvIDJcclxuICAgICAgKTtcclxuICAgICAgY29uc3QgY2FtZXJhTWFyZ2luWSA9IE1hdGguZmxvb3IoXHJcbiAgICAgICAgIChwbGF5ZXJDYW1lcmEuaGVpZ2h0IC0gcGxheWVyQ2FtZXJhLmZvY3VzLmhlaWdodCkgLyAyXHJcbiAgICAgICk7XHJcbiAgICAgIGlmIChcclxuICAgICAgICAgcGxheWVyLmxvY2F0aW9uLnggPj1cclxuICAgICAgICAgcGxheWVyQ2FtZXJhLmZvY3VzLndpZHRoICsgcGxheWVyQ2FtZXJhLnggKyBjYW1lcmFNYXJnaW5YXHJcbiAgICAgICkge1xyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEueCA9XHJcbiAgICAgICAgICAgIHBsYXllci5sb2NhdGlvbi54ICsgMSAtIHBsYXllckNhbWVyYS5mb2N1cy53aWR0aCAtIGNhbWVyYU1hcmdpblg7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKFxyXG4gICAgICAgICBwbGF5ZXIubG9jYXRpb24ueSA+PVxyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEuZm9jdXMuaGVpZ2h0ICsgcGxheWVyQ2FtZXJhLnkgKyBjYW1lcmFNYXJnaW5ZXHJcbiAgICAgICkge1xyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEueSA9XHJcbiAgICAgICAgICAgIHBsYXllci5sb2NhdGlvbi55ICsgMSAtIHBsYXllckNhbWVyYS5mb2N1cy5oZWlnaHQgLSBjYW1lcmFNYXJnaW5ZO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChwbGF5ZXIubG9jYXRpb24ueCA8IHBsYXllckNhbWVyYS54ICsgY2FtZXJhTWFyZ2luWCkge1xyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEueCA9IHBsYXllci5sb2NhdGlvbi54IC0gY2FtZXJhTWFyZ2luWDtcclxuICAgICAgfVxyXG4gICAgICBpZiAocGxheWVyLmxvY2F0aW9uLnkgPCBwbGF5ZXJDYW1lcmEueSArIGNhbWVyYU1hcmdpblkpIHtcclxuICAgICAgICAgcGxheWVyQ2FtZXJhLnkgPSBwbGF5ZXIubG9jYXRpb24ueSAtIGNhbWVyYU1hcmdpblk7XHJcbiAgICAgIH1cclxuICAgfVxyXG5cclxuICAgaWYgKHBsYXllckNhbWVyYS5jYW52YXMpIHtcclxuICAgICAgcGxheWVyQ2FtZXJhLndpZHRoID0gTWF0aC5jZWlsKFxyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEuY2FudmFzLndpZHRoIC8gcGxheWVyQ2FtZXJhLnRpbGVTaXplXHJcbiAgICAgICk7XHJcbiAgICAgIHBsYXllckNhbWVyYS5oZWlnaHQgPSBNYXRoLmNlaWwoXHJcbiAgICAgICAgIHBsYXllckNhbWVyYS5jYW52YXMuaGVpZ2h0IC8gcGxheWVyQ2FtZXJhLnRpbGVTaXplXHJcbiAgICAgICk7XHJcbiAgIH1cclxufTtcclxuXHJcbmNvbnN0IHRpbGVFbnRpdGllczogeyBbTiBpbiBzdHJpbmddOiBTcHJpdGVFbnRpdHk8Tj4gfSA9ICgoXHJcbiAgIHRpbGVzOiB7IFtOIGluIHN0cmluZ106IEVudGl0eTxOLCB7IHNwcml0ZTogU3ByaXRlIH0+IH1cclxuKSA9PiB7XHJcbiAgIGNvbnN0IGVudGl0aWVzID0ge30gYXMgeyBbTiBpbiBzdHJpbmddOiBTcHJpdGVFbnRpdHk8Tj4gfTtcclxuXHJcbiAgIGZvciAoY29uc3QgbmFtZSBpbiB0aWxlcykge1xyXG4gICAgICBjb25zdCBlbnRpdHkgPSBjcmVhdGVTcHJpdGUodGlsZXNbbmFtZV0pO1xyXG5cclxuICAgICAgaWYgKGlzQ29sbGlkYWJsZSh0aWxlc1tuYW1lXSkpIHtcclxuICAgICAgICAgKGVudGl0eSBhcyBhbnkpLmNvbGxpc2lvbiA9ICh0aWxlc1tuYW1lXSBhcyBhbnkpLmNvbGxpc2lvbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZW50aXRpZXNbZW50aXR5LmlkXSA9IGVudGl0eTtcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIGVudGl0aWVzO1xyXG59KShjb25maWcuZW50aXRpZXMudGlsZXMpO1xyXG5cclxuY29uc3QgYWRkVGlsZSA9IChuYW1lOiBzdHJpbmcsIGxvY2F0aW9uOiBQb2ludDNEKSA9PiB7XHJcbiAgIHJldHVybiBleHRlbmRFbnRpdHkoYWRkQ2hpbGQoc2NlbmUucm9vdCwgdGlsZUVudGl0aWVzW25hbWVdKS5lbnRpdHksIHtcclxuICAgICAgbG9jYXRpb25cclxuICAgfSk7XHJcbn07XHJcblxyXG50aWxlRW50aXRpZXMucGxheWVyID0gY3JlYXRlU3ByaXRlKGNvbmZpZy5lbnRpdGllcy5wbGF5ZXIpO1xyXG5cclxubGV0IHBsYXllcjogRW50aXR5PFwicGxheWVyXCIsIHsgbG9jYXRpb246IFBvaW50M0QgfT4gPSBudWxsIGFzIGFueTtcclxuXHJcbmZ1bmN0aW9uIGlzQ29sbGlkYWJsZTxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24+XHJcbik6IGVudGl0eSBpcyBFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uICYgeyBjb2xsaXNpb246IGJvb2xlYW4gfT4ge1xyXG4gICByZXR1cm4gXCJjb2xsaXNpb25cIiBpbiBlbnRpdHk7XHJcbn1cclxuXHJcbmNvbnN0IGNvbGxpc2lvbk1hcDogYm9vbGVhbltdW10gPSBbXTtcclxuXHJcbmZvciAobGV0IHogPSAwOyB6IDwgY29uZmlnLm1hcC5sZW5ndGg7IHorKykge1xyXG4gICBmb3IgKGxldCB5ID0gMDsgeSA8IGNvbmZpZy5tYXBbel0ubGVuZ3RoOyB5KyspIHtcclxuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBjb25maWcubWFwW3pdW3ldLmxlbmd0aDsgeCsrKSB7XHJcbiAgICAgICAgIGNvbnN0IG5hbWUgPSBjb25maWcudGlsZXNbY29uZmlnLm1hcFt6XVt5XVt4XV07XHJcblxyXG4gICAgICAgICBjb25zdCBlbnRpdHkgPSBhZGRUaWxlKG5hbWUsIHtcclxuICAgICAgICAgICAgeCxcclxuICAgICAgICAgICAgeSxcclxuICAgICAgICAgICAgelxyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIGlmIChpc0NvbGxpZGFibGUoZW50aXR5KSkge1xyXG4gICAgICAgICAgICBpZiAoIWNvbGxpc2lvbk1hcFt4XSkge1xyXG4gICAgICAgICAgICAgICBjb2xsaXNpb25NYXBbeF0gPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb2xsaXNpb25NYXBbeF1beV0gPSBlbnRpdHkuY29sbGlzaW9uO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBpZiAobmFtZSA9PT0gXCJwbGF5ZXJcIikge1xyXG4gICAgICAgICAgICBwbGF5ZXIgPSBlbnRpdHkgYXMgYW55O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG59XHJcblxyXG5wbGF5ZXJDYW1lcmEueCA9IE1hdGguZmxvb3IocGxheWVyLmxvY2F0aW9uLnggLSBwbGF5ZXJDYW1lcmEud2lkdGggLyAyKTtcclxucGxheWVyQ2FtZXJhLnkgPSBNYXRoLmZsb29yKHBsYXllci5sb2NhdGlvbi55IC0gcGxheWVyQ2FtZXJhLmhlaWdodCAvIDIpO1xyXG5cclxuZXhwb3J0IGVudW0gS2V5TWFwIHtcclxuICAgXCJsZWZ0XCIgPSAzNyxcclxuICAgXCJ1cFwiID0gMzgsXHJcbiAgIFwicmlnaHRcIiA9IDM5LFxyXG4gICBcImRvd25cIiA9IDQwXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBoYW5kbGVJbnB1dCA9IChrZXlzUHJlc3NlZDogeyBba2V5OiBudW1iZXJdOiBib29sZWFuIH0pID0+IHtcclxuICAgbGV0IHR1cm5UYWtlbiA9IGZhbHNlO1xyXG4gICBsZXQgdmVjTW92ZW1lbnQ6IFtudW1iZXIsIG51bWJlcl0gPSBbMCwgMF07XHJcblxyXG4gICBjb25zdCBjb2xsaXNpb25BdCA9IChyZWxYOiBudW1iZXIsIHJlbFk6IG51bWJlcikgPT4ge1xyXG4gICAgICBjb25zdCBuZXdYID0gcGxheWVyLmxvY2F0aW9uLnggKyByZWxYO1xyXG4gICAgICBjb25zdCBuZXdZID0gcGxheWVyLmxvY2F0aW9uLnkgKyByZWxZO1xyXG4gICAgICByZXR1cm4gY29sbGlzaW9uTWFwW25ld1hdICYmIGNvbGxpc2lvbk1hcFtuZXdYXVtuZXdZXTtcclxuICAgfTtcclxuXHJcbiAgIGlmIChrZXlzUHJlc3NlZFtLZXlNYXAubGVmdF0gJiYgIWNvbGxpc2lvbkF0KC0xLCAwKSkgdmVjTW92ZW1lbnRbMF0tLTtcclxuICAgaWYgKGtleXNQcmVzc2VkW0tleU1hcC51cF0gJiYgIWNvbGxpc2lvbkF0KDAsIC0xKSkgdmVjTW92ZW1lbnRbMV0tLTtcclxuICAgaWYgKGtleXNQcmVzc2VkW0tleU1hcC5yaWdodF0gJiYgIWNvbGxpc2lvbkF0KDEsIDApKSB2ZWNNb3ZlbWVudFswXSsrO1xyXG4gICBpZiAoa2V5c1ByZXNzZWRbS2V5TWFwLmRvd25dICYmICFjb2xsaXNpb25BdCgwLCAxKSkgdmVjTW92ZW1lbnRbMV0rKztcclxuXHJcbiAgIC8vIE5vIGRpYWdvbmFsIG1vdmVtZW50XHJcbiAgIGlmIChNYXRoLmFicyh2ZWNNb3ZlbWVudFswXSkgKyBNYXRoLmFicyh2ZWNNb3ZlbWVudFsxXSkgPT09IDEpIHtcclxuICAgICAgcGxheWVyLmxvY2F0aW9uLnggKz0gdmVjTW92ZW1lbnRbMF07XHJcbiAgICAgIHBsYXllci5sb2NhdGlvbi55ICs9IHZlY01vdmVtZW50WzFdO1xyXG5cclxuICAgICAgdHVyblRha2VuID0gdHJ1ZTtcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIHR1cm5UYWtlbjtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcmVSZW5kZXIgPSAoe1xyXG4gICBjYW1lcmEsXHJcbiAgIGFuaW1TdGF0ZVxyXG59OiB7XHJcbiAgIGNhbWVyYTogQ2FtZXJhO1xyXG4gICBhbmltU3RhdGU6IG51bWJlcjtcclxufSkgPT4ge1xyXG4gICBjZW50ZXJDYW1lcmEoKTtcclxufTtcclxuIiwiZXhwb3J0IGludGVyZmFjZSBQb2ludCB7XHJcbiAgIHg6IG51bWJlcjtcclxuICAgeTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBvaW50M0QgZXh0ZW5kcyBQb2ludCB7XHJcbiAgIHo6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZWN0YW5nbGUgZXh0ZW5kcyBQb2ludCB7XHJcbiAgIHdpZHRoOiBudW1iZXI7XHJcbiAgIGhlaWdodDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgaXNPdmVybGFwID0gKFxyXG4gICB7XHJcbiAgICAgIHg6IHgxLFxyXG4gICAgICB5OiB5MSxcclxuICAgICAgd2lkdGg6IHcxID0gMCxcclxuICAgICAgaGVpZ2h0OiBoMSA9IDBcclxuICAgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg/OiBudW1iZXI7IGhlaWdodD86IG51bWJlciB9LFxyXG4gICB7XHJcbiAgICAgIHg6IHgyLFxyXG4gICAgICB5OiB5MixcclxuICAgICAgd2lkdGg6IHcyID0gMCxcclxuICAgICAgaGVpZ2h0OiBoMiA9IDBcclxuICAgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg/OiBudW1iZXI7IGhlaWdodD86IG51bWJlciB9XHJcbikgPT4geDEgPD0geDIgKyB3MiAmJiB4MSArIHcxID49IHgyICYmIHkxIDw9IHkyICsgaDIgJiYgeTEgKyBoMSA+PSB5MjtcclxuIiwiaW1wb3J0IHsgcmVuZGVyLCBDYW1lcmEgfSBmcm9tIFwiLi9yZW5kZXJlclwiO1xyXG5pbXBvcnQgeyBLZXlNYXAsIGhhbmRsZUlucHV0LCBjcmVhdGVQbGF5ZXJDYW1lcmEsIHByZVJlbmRlciB9IGZyb20gXCIuL2dhbWVcIjtcclxuXHJcbi8vIFNldHVwXHJcblxyXG5jb25zdCAkY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuXHJcbiRjYW52YXMud2lkdGggPSBpbm5lcldpZHRoO1xyXG4kY2FudmFzLmhlaWdodCA9IGlubmVySGVpZ2h0O1xyXG4kY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4kY2FudmFzLnN0eWxlLnRvcCA9IFwiMFwiO1xyXG4kY2FudmFzLnN0eWxlLmxlZnQgPSBcIjBcIjtcclxuJGNhbnZhcy5zdHlsZS5tYXJnaW4gPSBcIjBcIjtcclxuXHJcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoJGNhbnZhcyk7XHJcblxyXG4vLyBJbnB1dFxyXG4vLyBUT0RPOiBjbGVhbiB1cCBidWZmZXJpbmcgY29kZSwgb3B0aW1pemU/XHJcblxyXG5jb25zdCBrZXlzRG93bjogeyBba2V5OiBudW1iZXJdOiBib29sZWFuIH0gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5jb25zdCBrZXlzVXA6IHR5cGVvZiBrZXlzRG93biA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZSA9PiB7XHJcbiAgIGlmIChlLmtleUNvZGUgaW4gS2V5TWFwKSB7XHJcbiAgICAgIGtleXNEb3duW2Uua2V5Q29kZV0gPSB0cnVlO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgIH1cclxufSk7XHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZSA9PiB7XHJcbiAgIGlmIChlLmtleUNvZGUgaW4gS2V5TWFwKSB7XHJcbiAgICAgIGtleXNVcFtlLmtleUNvZGVdID0gdHJ1ZTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICB9XHJcbn0pO1xyXG5cclxubGV0IHByZXZJbnB1dCA9IDA7XHJcblxyXG5jb25zdCBpbnB1dCA9ICgpID0+IHtcclxuICAgY29uc3QgZGVsdGEgPSB0aW1lLmN1clRpbWUgLSBwcmV2SW5wdXQ7XHJcblxyXG4gICBsZXQga2V5UHJlc3NlZCA9IGZhbHNlO1xyXG5cclxuICAgZm9yIChsZXQga2V5Q29kZSBpbiBLZXlNYXApIHtcclxuICAgICAgaWYgKCFpc05hTihOdW1iZXIoa2V5Q29kZSkpKSB7XHJcbiAgICAgICAgIGlmIChkZWx0YSA8IHRpbWUuYW5pbVJlc29sdXRpb24pIHtcclxuICAgICAgICAgICAga2V5c0Rvd25ba2V5Q29kZV0gPSBrZXlzVXBba2V5Q29kZV0gPyBmYWxzZSA6IGtleXNEb3duW2tleUNvZGVdO1xyXG4gICAgICAgICAgICBrZXlzVXBba2V5Q29kZV0gPSBmYWxzZTtcclxuICAgICAgICAgICAga2V5UHJlc3NlZCA9IGZhbHNlO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBrZXlQcmVzc2VkID0ga2V5c0Rvd25ba2V5Q29kZV0gfHwga2V5UHJlc3NlZDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuXHJcbiAgIGlmIChrZXlQcmVzc2VkKSB7XHJcbiAgICAgIGNvbnN0IHR1cm5UYWtlbiA9IGhhbmRsZUlucHV0KFxyXG4gICAgICAgICBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCksIGtleXNEb3duKVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKHR1cm5UYWtlbikgcHJldklucHV0ID0gdGltZS5jdXJUaW1lO1xyXG4gICB9XHJcbn07XHJcblxyXG4vLyBGUFMgQ291bnRlclxyXG5cclxuZGVjbGFyZSBjbGFzcyBTdGF0cyB7XHJcbiAgIGRvbTogTm9kZTtcclxuICAgdXBkYXRlOiAoKSA9PiB2b2lkO1xyXG59XHJcblxyXG5jb25zdCBzdGF0cyA9IG5ldyBTdGF0cygpO1xyXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN0YXRzLmRvbSk7XHJcblxyXG4vLyBSZW5kZXIgTG9vcFxyXG5cclxuY29uc3QgdGltZSA9IHtcclxuICAgc3RhcnQ6IDAsXHJcbiAgIHByZXZUaW1lOiAwLFxyXG4gICBjdXJUaW1lOiBwZXJmb3JtYW5jZS5ub3coKSxcclxuICAgYW5pbUNvdW50ZXI6IDAsXHJcbiAgIGFuaW1TdGF0ZTogMCxcclxuICAgYW5pbVJlc29sdXRpb246IDUwMFxyXG59O1xyXG5cclxuY29uc3QgY2FtZXJhID0gY3JlYXRlUGxheWVyQ2FtZXJhKCRjYW52YXMpIGFzIENhbWVyYTtcclxuXHJcbmNvbnN0IGxvb3AgPSAoKSA9PiB7XHJcbiAgIGlmICh0aW1lLnN0YXJ0ID09PSAwKSB0aW1lLnN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgIHRpbWUuY3VyVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG4gICBjb25zdCBkZWx0YVRpbWUgPSB0aW1lLmN1clRpbWUgLSB0aW1lLnByZXZUaW1lO1xyXG5cclxuICAgdGltZS5hbmltQ291bnRlciArPSBkZWx0YVRpbWU7XHJcbiAgIHRpbWUuYW5pbVN0YXRlID0gTWF0aC5mbG9vcih0aW1lLmFuaW1Db3VudGVyIC8gdGltZS5hbmltUmVzb2x1dGlvbik7XHJcblxyXG4gICBpbnB1dCgpO1xyXG5cclxuICAgaWYgKHRpbWUucHJldlRpbWUgIT09IDApIHtcclxuICAgICAgJGNhbnZhcy53aWR0aCA9IGlubmVyV2lkdGg7XHJcbiAgICAgICRjYW52YXMuaGVpZ2h0ID0gaW5uZXJIZWlnaHQ7XHJcbiAgICAgIGNvbnN0IGN0eCA9ICRjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICBpZiAoY3R4KSB7XHJcbiAgICAgICAgIHByZVJlbmRlcih7IGNhbWVyYSwgYW5pbVN0YXRlOiB0aW1lLmFuaW1TdGF0ZSB9KTtcclxuICAgICAgICAgcmVuZGVyKHtcclxuICAgICAgICAgICAgY3R4LFxyXG4gICAgICAgICAgICBjYW1lcmEsXHJcbiAgICAgICAgICAgIGFuaW1TdGF0ZTogdGltZS5hbmltU3RhdGVcclxuICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG5cclxuICAgc3RhdHMudXBkYXRlKCk7XHJcbiAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICAgdGltZS5wcmV2VGltZSA9IHRpbWUuY3VyVGltZTtcclxufTtcclxuXHJcbmxvb3AoKTtcclxuIiwiaW1wb3J0IHsgU3ByaXRlLCBTcHJpdGVFbnRpdHksIGlzU3ByaXRlRW50aXR5IH0gZnJvbSBcIi4vc3ByaXRlXCI7XHJcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSBcIi4vc2NlbmVcIjtcclxuaW1wb3J0IHsgUmVjdGFuZ2xlLCBpc092ZXJsYXAsIFBvaW50M0QgfSBmcm9tIFwiLi9nZW9tZXRyeVwiO1xyXG5pbXBvcnQgeyBpc1RhbmdpYmxlRW50aXR5LCBFbnRpdHkgfSBmcm9tIFwiLi9lbnRpdHlcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2FtZXJhIGV4dGVuZHMgUmVjdGFuZ2xlIHtcclxuICAgc2NlbmU6IFNjZW5lO1xyXG4gICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICB0aWxlU2l6ZTogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBkcmF3U3ByaXRlID0gKFxyXG4gICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcclxuICAgc3ByaXRlOiBTcHJpdGUsXHJcbiAgIHRpbGVTaXplOiBudW1iZXIsXHJcbiAgIGRzdFg6IG51bWJlcixcclxuICAgZHN0WTogbnVtYmVyXHJcbikgPT4ge1xyXG4gICBjdHguZHJhd0ltYWdlKFxyXG4gICAgICBzcHJpdGUuaW1hZ2UsXHJcbiAgICAgIHNwcml0ZS54ICogc3ByaXRlLnRpbGVTaXplLFxyXG4gICAgICBzcHJpdGUueSAqIHNwcml0ZS50aWxlU2l6ZSxcclxuICAgICAgc3ByaXRlLndpZHRoICogc3ByaXRlLnRpbGVTaXplLFxyXG4gICAgICBzcHJpdGUuaGVpZ2h0ICogc3ByaXRlLnRpbGVTaXplLFxyXG4gICAgICBkc3RYICogdGlsZVNpemUsXHJcbiAgICAgIGRzdFkgKiB0aWxlU2l6ZSxcclxuICAgICAgc3ByaXRlLndpZHRoICogdGlsZVNpemUsXHJcbiAgICAgIHNwcml0ZS5oZWlnaHQgKiB0aWxlU2l6ZVxyXG4gICApO1xyXG59O1xyXG5cclxuY29uc3QgZHJhd0VudGl0eSA9IChcclxuICAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXHJcbiAgIGVudGl0eTogU3ByaXRlRW50aXR5PHN0cmluZz4sXHJcbiAgIGFuaW1hdGlvbjogbnVtYmVyLFxyXG4gICB0aWxlU2l6ZTogbnVtYmVyLFxyXG4gICBkc3RYOiBudW1iZXIsXHJcbiAgIGRzdFk6IG51bWJlclxyXG4pID0+IHtcclxuICAgY29uc3Qgc3ByaXRlID0gQXJyYXkuaXNBcnJheShlbnRpdHkuc3ByaXRlKVxyXG4gICAgICA/IGVudGl0eS5zcHJpdGVbYW5pbWF0aW9uICUgZW50aXR5LnNwcml0ZS5sZW5ndGhdXHJcbiAgICAgIDogZW50aXR5LnNwcml0ZTtcclxuICAgZHJhd1Nwcml0ZShjdHgsIHNwcml0ZSwgdGlsZVNpemUsIGRzdFgsIGRzdFkpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlbmRlciA9ICh7XHJcbiAgIGN0eCxcclxuICAgY2FtZXJhLFxyXG4gICBhbmltU3RhdGVcclxufToge1xyXG4gICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcclxuICAgY2FtZXJhOiBDYW1lcmE7XHJcbiAgIGFuaW1TdGF0ZTogbnVtYmVyO1xyXG59KSA9PiB7XHJcbiAgIGN0eC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgIGN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW1lcmEuY2FudmFzLndpZHRoLCBjYW1lcmEuY2FudmFzLmhlaWdodCk7XHJcblxyXG4gICBjb25zdCBzcHJpdGVzOiB7XHJcbiAgICAgIFtrZXk6IG51bWJlcl06IEVudGl0eTxcclxuICAgICAgICAgc3RyaW5nLFxyXG4gICAgICAgICB7IHNwcml0ZTogU3ByaXRlIHwgU3ByaXRlW107IGxvY2F0aW9uOiBQb2ludDNEIH1cclxuICAgICAgPltdO1xyXG4gICB9ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuXHJcbiAgIGZvciAoY29uc3Qgbm9kZSBvZiBjYW1lcmEuc2NlbmUubm9kZXMpIHtcclxuICAgICAgY29uc3QgZW50aXR5ID0gbm9kZS5lbnRpdHk7XHJcbiAgICAgIGlmIChcclxuICAgICAgICAgaXNTcHJpdGVFbnRpdHkoZW50aXR5KSAmJlxyXG4gICAgICAgICBpc1RhbmdpYmxlRW50aXR5KGVudGl0eSkgJiZcclxuICAgICAgICAgaXNPdmVybGFwKGNhbWVyYSwgZW50aXR5LmxvY2F0aW9uKVxyXG4gICAgICApIHtcclxuICAgICAgICAgc3ByaXRlc1tlbnRpdHkubG9jYXRpb24uel0gPSBzcHJpdGVzW2VudGl0eS5sb2NhdGlvbi56XSB8fCBbXTtcclxuXHJcbiAgICAgICAgIHNwcml0ZXNbZW50aXR5LmxvY2F0aW9uLnpdLnB1c2goZW50aXR5KTtcclxuICAgICAgfVxyXG4gICB9XHJcblxyXG4gICBmb3IgKGNvbnN0IHogaW4gc3ByaXRlcykge1xyXG4gICAgICBmb3IgKGNvbnN0IHNwcml0ZSBvZiBzcHJpdGVzW3pdKSB7XHJcbiAgICAgICAgIGRyYXdFbnRpdHkoXHJcbiAgICAgICAgICAgIGN0eCxcclxuICAgICAgICAgICAgc3ByaXRlLFxyXG4gICAgICAgICAgICBhbmltU3RhdGUsXHJcbiAgICAgICAgICAgIGNhbWVyYS50aWxlU2l6ZSxcclxuICAgICAgICAgICAgc3ByaXRlLmxvY2F0aW9uLnggLSBjYW1lcmEueCxcclxuICAgICAgICAgICAgc3ByaXRlLmxvY2F0aW9uLnkgLSBjYW1lcmEueVxyXG4gICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuIiwiaW1wb3J0IHsgRW50aXR5LCBjcmVhdGVFbnRpdHkgfSBmcm9tIFwiLi9lbnRpdHlcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2NlbmUge1xyXG4gICBub2RlczogTm9kZTxzdHJpbmcsIHt9PltdO1xyXG4gICByb290OiBOb2RlPHN0cmluZywge30+O1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlU2NlbmUgPSAoKSA9PiB7XHJcbiAgIGNvbnN0IHNjZW5lID0ge1xyXG4gICAgICBub2RlczogW10sXHJcbiAgICAgIHJvb3Q6IHtcclxuICAgICAgICAgc2NlbmU6IG51bGwgYXMgU2NlbmUgfCBudWxsLFxyXG4gICAgICAgICBwYXJlbnQ6IG51bGwsXHJcbiAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgZW50aXR5OiBjcmVhdGVFbnRpdHkoXCJzY2VuZVwiKVxyXG4gICAgICB9XHJcbiAgIH07XHJcblxyXG4gICBzY2VuZS5yb290LnNjZW5lID0gc2NlbmUgYXMgU2NlbmU7XHJcblxyXG4gICByZXR1cm4gc2NlbmUgYXMgU2NlbmU7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgYWRkQ2hpbGQgPSA8VHlwZSBleHRlbmRzIHN0cmluZywgRXh0ZW5zaW9uPihcclxuICAgbm9kZTogTm9kZTxzdHJpbmcsIHt9PixcclxuICAgZW50aXR5OiBFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uPlxyXG4pID0+IHtcclxuICAgY29uc3QgY2hpbGQ6IE5vZGU8VHlwZSwgRXh0ZW5zaW9uPiA9IHtcclxuICAgICAgc2NlbmU6IG5vZGUuc2NlbmUsXHJcbiAgICAgIHBhcmVudDogbm9kZSxcclxuICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICBlbnRpdHk6IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShudWxsKSwgZW50aXR5KVxyXG4gICB9O1xyXG5cclxuICAgbm9kZS5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcclxuICAgbm9kZS5zY2VuZS5ub2Rlcy5wdXNoKGNoaWxkKTtcclxuXHJcbiAgIHJldHVybiBjaGlsZDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZW1vdmVDaGlsZCA9IDxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBub2RlOiBOb2RlPFR5cGUsIEV4dGVuc2lvbj5cclxuKSA9PiB7XHJcbiAgIGlmIChub2RlLnBhcmVudCAhPSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHBhcmVudEluZGV4ID0gbm9kZS5wYXJlbnQuY2hpbGRyZW4uaW5kZXhPZihub2RlKTtcclxuICAgICAgbm9kZS5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKHBhcmVudEluZGV4LCAxKTtcclxuXHJcbiAgICAgIGNvbnN0IHNjZW5lSW5kZXggPSBub2RlLnNjZW5lLm5vZGVzLmluZGV4T2Yobm9kZSk7XHJcbiAgICAgIG5vZGUuc2NlbmUubm9kZXMuc3BsaWNlKHNjZW5lSW5kZXgsIDEpO1xyXG4gICB9XHJcbn07XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE5vZGU8VHlwZSBleHRlbmRzIHN0cmluZywgRXh0ZW5zaW9uPiB7XHJcbiAgIHNjZW5lOiBTY2VuZTtcclxuICAgcGFyZW50OiBOb2RlPHN0cmluZywge30+IHwgbnVsbDtcclxuICAgY2hpbGRyZW46IE5vZGU8c3RyaW5nLCB7fT5bXTtcclxuICAgZW50aXR5OiBFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uPjtcclxufVxyXG4iLCJpbXBvcnQgeyBFbnRpdHksIGNyZWF0ZUVudGl0eSB9IGZyb20gXCIuL2VudGl0eVwiO1xyXG5pbXBvcnQgeyBSZWN0YW5nbGUgfSBmcm9tIFwiLi9nZW9tZXRyeVwiO1xyXG5cclxuZXhwb3J0IHR5cGUgSW1hZ2UgPSBIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTENhbnZhc0VsZW1lbnQgfCBJbWFnZUJpdG1hcDtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3ByaXRlIGV4dGVuZHMgUmVjdGFuZ2xlIHtcclxuICAgaW1hZ2U6IEltYWdlO1xyXG4gICB0aWxlU2l6ZTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBTcHJpdGVFbnRpdHk8VHlwZSBleHRlbmRzIHN0cmluZz4gPSBFbnRpdHk8XHJcbiAgIFR5cGUsXHJcbiAgIHtcclxuICAgICAgc3ByaXRlOiBTcHJpdGUgfCBTcHJpdGVbXTtcclxuICAgfVxyXG4+O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzU3ByaXRlRW50aXR5PFR5cGUgZXh0ZW5kcyBzdHJpbmcsIEV4dGVuc2lvbj4oXHJcbiAgIGVudGl0eTogRW50aXR5PHN0cmluZywgRXh0ZW5zaW9uPlxyXG4pOiBlbnRpdHkgaXMgRW50aXR5PFxyXG4gICBUeXBlLFxyXG4gICBFeHRlbnNpb24gJiB7XHJcbiAgICAgIHNwcml0ZTogU3ByaXRlIHwgU3ByaXRlW107XHJcbiAgIH1cclxuPiB7XHJcbiAgIHJldHVybiBcInNwcml0ZVwiIGluIGVudGl0eTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVNwcml0ZSA9IDxUeXBlIGV4dGVuZHMgc3RyaW5nPih7XHJcbiAgIGlkLFxyXG4gICBzcHJpdGVcclxufToge1xyXG4gICBpZDogVHlwZTtcclxuICAgc3ByaXRlOiBTcHJpdGUgfCBTcHJpdGVbXTtcclxufSkgPT4ge1xyXG4gICBsZXQgc3ByaXRlQ29weSA9IG51bGwgYXMgYW55O1xyXG5cclxuICAgaWYgKEFycmF5LmlzQXJyYXkoc3ByaXRlKSkge1xyXG4gICAgICBzcHJpdGVDb3B5ID0gc3ByaXRlLnNsaWNlKCk7XHJcbiAgICAgIGZvciAoY29uc3QgaSBpbiBzcHJpdGUpIHtcclxuICAgICAgICAgc3ByaXRlW2ldID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpIGFzIHt9LCBzcHJpdGVbaV0pO1xyXG4gICAgICB9XHJcbiAgIH0gZWxzZSB7XHJcbiAgICAgIHNwcml0ZUNvcHkgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCkgYXMge30sIHNwcml0ZSk7XHJcbiAgIH1cclxuXHJcbiAgIHJldHVybiBjcmVhdGVFbnRpdHkoaWQsIHtcclxuICAgICAgc3ByaXRlOiBzcHJpdGVDb3B5XHJcbiAgIH0pIGFzIFNwcml0ZUVudGl0eTxUeXBlPjtcclxufTtcclxuIl19
