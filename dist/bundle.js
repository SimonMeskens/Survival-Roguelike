(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entities = Object.create(null);
exports.createEntity = (id, extension) => {
    if (entities[id] != null) {
        throw new Error("Entity already exists");
    }
    entities[id] =
        extension != null ? Object.assign({}, extension, { id }) : { id };
    return entities[id];
};
exports.extendEntity = (entity, extension) => {
    return Object.assign(entity, extension);
};
function isTangibleEntity(point) {
    return "location" in point;
}
exports.isTangibleEntity = isTangibleEntity;
},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const getImageFromId = (id) => document.getElementById(id);
exports.entities = {
    player: {
        id: "player",
        sprite: [
            {
                image: getImageFromId("resource-player0"),
                tileSize: 16,
                x: 2,
                y: 3,
                width: 1,
                height: 1
            },
            {
                image: getImageFromId("resource-player1"),
                tileSize: 16,
                x: 2,
                y: 3,
                width: 1,
                height: 1
            }
        ]
    },
    // Better way to handle tiles/tilesets?
    tiles: {
        grass: {
            id: "tiles/grass",
            sprite: {
                image: getImageFromId("resource-floor"),
                tileSize: 16,
                x: 8,
                y: 7,
                width: 1,
                height: 1
            },
            collision: false
        },
        wall: {
            id: "tiles/wall",
            sprite: {
                image: getImageFromId("resource-wall"),
                tileSize: 16,
                x: 3,
                y: 3,
                width: 1,
                height: 1
            },
            collision: true
        }
    }
};
exports.map = [
    [
        "################",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#....######....#",
        "#....#....#....#",
        "#....#....#....#",
        "#....#....#....#",
        "#....##.###....#",
        "#..............#",
        "#..............#",
        "#..............#",
        "#..............#",
        "################"
    ],
    [
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "       @        ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                ",
        "                "
    ]
];
exports.tiles = {
    "#": exports.entities.tiles.wall.id,
    ".": exports.entities.tiles.grass.id,
    "@": exports.entities.player.id
};
},{}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const config = require("./game.config");
const scene_1 = require("./scene");
const sprite_1 = require("./sprite");
const entity_1 = require("./entity");
exports.scene = scene_1.createScene();
exports.playerCamera = {
    scene: exports.scene,
    tileSize: 48,
    x: 0,
    y: 0,
    width: 12,
    height: 12,
    focus: {
        width: 6,
        height: 6
    }
};
const tileEntities = ((tiles) => {
    const entities = {};
    for (const name in tiles) {
        const entity = sprite_1.createSprite(tiles[name]);
        if (isCollidable(tiles[name])) {
            entity.collision = tiles[name].collision;
        }
        entities[entity.id] = entity;
    }
    return entities;
})(config.entities.tiles);
const addTile = (name, location) => {
    return entity_1.extendEntity(scene_1.addChild(exports.scene.root, tileEntities[name]).entity, {
        location
    });
};
tileEntities.player = sprite_1.createSprite(config.entities.player);
let player = null;
function isCollidable(entity) {
    return "collision" in entity;
}
const collisionMap = [];
for (let z = 0; z < config.map.length; z++) {
    for (let y = 0; y < config.map[z].length; y++) {
        for (let x = 0; x < config.map[z][y].length; x++) {
            const name = config.tiles[config.map[z][y][x]];
            const entity = addTile(name, {
                x,
                y,
                z
            });
            if (isCollidable(entity)) {
                if (!collisionMap[x]) {
                    collisionMap[x] = [];
                }
                collisionMap[x][y] = entity.collision;
            }
            if (name === "player") {
                player = entity;
            }
        }
    }
}
exports.playerCamera.x = Math.floor(player.location.x - exports.playerCamera.width / 2);
exports.playerCamera.y = Math.floor(player.location.y - exports.playerCamera.height / 2);
var KeyMap;
(function (KeyMap) {
    KeyMap[KeyMap["left"] = 37] = "left";
    KeyMap[KeyMap["up"] = 38] = "up";
    KeyMap[KeyMap["right"] = 39] = "right";
    KeyMap[KeyMap["down"] = 40] = "down";
})(KeyMap = exports.KeyMap || (exports.KeyMap = {}));
exports.handleInput = (keysPressed) => {
    let turnTaken = false;
    let vecMovement = [0, 0];
    const collisionAt = (relX, relY) => {
        const newX = player.location.x + relX;
        const newY = player.location.y + relY;
        return collisionMap[newX] && collisionMap[newX][newY];
    };
    if (keysPressed[KeyMap.left] && !collisionAt(-1, 0))
        vecMovement[0]--;
    if (keysPressed[KeyMap.up] && !collisionAt(0, -1))
        vecMovement[1]--;
    if (keysPressed[KeyMap.right] && !collisionAt(1, 0))
        vecMovement[0]++;
    if (keysPressed[KeyMap.down] && !collisionAt(0, 1))
        vecMovement[1]++;
    // No diagonal movement
    if (Math.abs(vecMovement[0]) + Math.abs(vecMovement[1]) === 1) {
        player.location.x += vecMovement[0];
        player.location.y += vecMovement[1];
        const cameraMarginX = Math.floor((exports.playerCamera.width - exports.playerCamera.focus.width) / 2);
        const cameraMarginY = Math.floor((exports.playerCamera.height - exports.playerCamera.focus.height) / 2);
        if (player.location.x >=
            exports.playerCamera.focus.width + exports.playerCamera.x + cameraMarginX) {
            exports.playerCamera.x =
                player.location.x + 1 - exports.playerCamera.focus.width - cameraMarginX;
        }
        if (player.location.y >=
            exports.playerCamera.focus.height + exports.playerCamera.y + cameraMarginY) {
            exports.playerCamera.y =
                player.location.y + 1 - exports.playerCamera.focus.height - cameraMarginY;
        }
        if (player.location.x < exports.playerCamera.x + cameraMarginX) {
            exports.playerCamera.x = player.location.x - cameraMarginX;
        }
        if (player.location.y < exports.playerCamera.y + cameraMarginY) {
            exports.playerCamera.y = player.location.y - cameraMarginY;
        }
        turnTaken = true;
    }
    return turnTaken;
};
},{"./entity":1,"./game.config":2,"./scene":7,"./sprite":8}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isOverlap = ({ x: x1, y: y1, width: w1 = 0, height: h1 = 0 }, { x: x2, y: y2, width: w2 = 0, height: h2 = 0 }) => x1 <= x2 + w2 && x1 + w1 >= x2 && y1 <= y2 + h2 && y1 + h1 >= y2;
},{}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const renderer_1 = require("./renderer");
const game_1 = require("./game");
// Setup
const $canvas = document.createElement("canvas");
const ctx = (() => {
    const context = $canvas.getContext("2d");
    if (context === null)
        throw new Error("No context!");
    else
        return context;
})();
$canvas.width = 576;
$canvas.height = 576;
$canvas.style.position = "absolute";
$canvas.style.top = "0";
$canvas.style.left = "0";
$canvas.style.bottom = "0";
$canvas.style.right = "0";
$canvas.style.margin = "auto";
ctx.imageSmoothingEnabled = false;
document.body.appendChild($canvas);
// Input
// TODO: clean up buffering code, optimize?
const keysDown = Object.create(null);
const keysUp = Object.create(null);
window.addEventListener("keydown", e => {
    if (e.keyCode in game_1.KeyMap) {
        keysDown[e.keyCode] = true;
        e.preventDefault();
    }
});
window.addEventListener("keyup", e => {
    if (e.keyCode in game_1.KeyMap) {
        keysUp[e.keyCode] = true;
        e.preventDefault();
    }
});
let prevInput = 0;
const input = () => {
    const delta = time.curTime - prevInput;
    let keyPressed = false;
    for (let keyCode in game_1.KeyMap) {
        if (!isNaN(Number(keyCode))) {
            if (delta < time.animResolution) {
                keysDown[keyCode] = keysUp[keyCode] ? false : keysDown[keyCode];
                keysUp[keyCode] = false;
                keyPressed = false;
            }
            else {
                keyPressed = keysDown[keyCode] || keyPressed;
            }
        }
    }
    if (keyPressed) {
        const turnTaken = game_1.handleInput(Object.assign(Object.create(null), keysDown));
        if (turnTaken)
            prevInput = time.curTime;
    }
};
const stats = new Stats();
document.body.appendChild(stats.dom);
// Render Loop
const time = {
    start: 0,
    prevTime: 0,
    curTime: performance.now(),
    animCounter: 0,
    animState: 0,
    animResolution: 500
};
const camera = (camera => {
    camera.canvas = $canvas;
    return camera;
})(game_1.playerCamera);
requestAnimationFrame(function loop() {
    if (time.start === 0)
        time.start = performance.now();
    time.curTime = performance.now();
    const deltaTime = time.curTime - time.prevTime;
    time.animCounter += deltaTime;
    time.animState = Math.floor(time.animCounter / time.animResolution);
    input();
    if (time.prevTime !== 0) {
        renderer_1.render({
            camera,
            animState: time.animState
        });
    }
    stats.update();
    requestAnimationFrame(loop);
    time.prevTime = time.curTime;
});
},{"./game":3,"./renderer":6}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const sprite_1 = require("./sprite");
const geometry_1 = require("./geometry");
const entity_1 = require("./entity");
const drawSprite = (ctx, sprite, tileSize, dstX, dstY) => {
    ctx.drawImage(sprite.image, sprite.x * sprite.tileSize, sprite.y * sprite.tileSize, sprite.width * sprite.tileSize, sprite.height * sprite.tileSize, dstX * tileSize, dstY * tileSize, sprite.width * tileSize, sprite.height * tileSize);
};
const drawEntity = (ctx, entity, animation, tileSize, dstX, dstY) => {
    const sprite = Array.isArray(entity.sprite)
        ? entity.sprite[animation % entity.sprite.length]
        : entity.sprite;
    drawSprite(ctx, sprite, tileSize, dstX, dstY);
};
exports.render = ({ camera, animState }) => {
    const ctx = camera.canvas.getContext("2d");
    if (ctx !== null) {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, camera.canvas.width, camera.canvas.height);
        const sprites = Object.create(null);
        for (const node of camera.scene.nodes) {
            const entity = node.entity;
            if (sprite_1.isSpriteEntity(entity) &&
                entity_1.isTangibleEntity(entity) &&
                geometry_1.isOverlap(camera, entity.location)) {
                sprites[entity.location.z] = sprites[entity.location.z] || [];
                sprites[entity.location.z].push(entity);
            }
        }
        for (const z in sprites) {
            for (const sprite of sprites[z]) {
                drawEntity(ctx, sprite, animState, camera.tileSize, sprite.location.x - camera.x, sprite.location.y - camera.y);
            }
        }
    }
};
},{"./entity":1,"./geometry":4,"./sprite":8}],7:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entity_1 = require("./entity");
exports.createScene = () => {
    const scene = {
        nodes: [],
        root: {
            scene: null,
            parent: null,
            children: [],
            entity: entity_1.createEntity("scene")
        }
    };
    scene.root.scene = scene;
    return scene;
};
exports.addChild = (node, entity) => {
    const child = {
        scene: node.scene,
        parent: node,
        children: [],
        entity: Object.assign(Object.create(null), entity)
    };
    node.children.push(child);
    node.scene.nodes.push(child);
    return child;
};
exports.removeChild = (node) => {
    if (node.parent != null) {
        const parentIndex = node.parent.children.indexOf(node);
        node.parent.children.splice(parentIndex, 1);
        const sceneIndex = node.scene.nodes.indexOf(node);
        node.scene.nodes.splice(sceneIndex, 1);
    }
};
},{"./entity":1}],8:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const entity_1 = require("./entity");
function isSpriteEntity(entity) {
    return "sprite" in entity;
}
exports.isSpriteEntity = isSpriteEntity;
exports.createSprite = ({ id, sprite }) => {
    let spriteCopy = null;
    if (Array.isArray(sprite)) {
        spriteCopy = sprite.slice();
        for (const i in sprite) {
            sprite[i] = Object.assign(Object.create(null), sprite[i]);
        }
    }
    else {
        spriteCopy = Object.assign(Object.create(null), sprite);
    }
    return entity_1.createEntity(id, {
        sprite: spriteCopy
    });
};
},{"./entity":1}]},{},[5])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZW50aXR5LnRzIiwic3JjL2dhbWUuY29uZmlnLnRzIiwic3JjL2dhbWUudHMiLCJzcmMvZ2VvbWV0cnkudHMiLCJzcmMvaW5kZXgudHMiLCJzcmMvcmVuZGVyZXIudHMiLCJzcmMvc2NlbmUudHMiLCJzcmMvc3ByaXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNFQSxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBTXhCLFFBQUEsWUFBWSxHQUFHLENBQ3pCLEVBQVEsRUFDUixTQUFxQjtJQUVyQixFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELFFBQVEsQ0FBQyxFQUFFLENBQUM7UUFDVCxTQUFTLElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUVyRSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBNEIsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFVyxRQUFBLFlBQVksR0FBRyxDQUN6QixNQUFnQyxFQUNoQyxTQUFxQjtJQUVyQixNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUdyQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDO0FBT0YsMEJBQ0csS0FBOEI7SUFFOUIsTUFBTSxDQUFDLFVBQVUsSUFBSSxLQUFLLENBQUM7QUFDOUIsQ0FBQztBQUpELDRDQUlDOzs7O0FDekNELE1BQU0sY0FBYyxHQUFHLENBQUMsRUFBVSxLQUMvQixRQUFRLENBQUMsY0FBYyxDQUFDLEVBQUUs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Q0FBQyxJQUFJLENBQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsTUFBTSxDQUFDLHFCQUFZLENBQUMsRUFBRSxFQUFFO1FBQ3JCLE1BQU0sRUFBRSxVQUFVO0tBQ3BCLENBQXVCLENBQUM7QUFDNUIsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7IFBvaW50M0QgfSBmcm9tIFwiLi9nZW9tZXRyeVwiO1xyXG5cclxuY29uc3QgZW50aXRpZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5cclxuZXhwb3J0IHR5cGUgRW50aXR5PFR5cGUgZXh0ZW5kcyBTdHJpbmcsIEV4dGVuc2lvbj4gPSB7XHJcbiAgIGlkOiBUeXBlO1xyXG59ICYgRXh0ZW5zaW9uO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUVudGl0eSA9IDxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBpZDogVHlwZSxcclxuICAgZXh0ZW5zaW9uPzogRXh0ZW5zaW9uXHJcbikgPT4ge1xyXG4gICBpZiAoZW50aXRpZXNbaWRdICE9IG51bGwpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW50aXR5IGFscmVhZHkgZXhpc3RzXCIpO1xyXG4gICB9XHJcblxyXG4gICBlbnRpdGllc1tpZF0gPVxyXG4gICAgICBleHRlbnNpb24gIT0gbnVsbCA/IE9iamVjdC5hc3NpZ24oe30sIGV4dGVuc2lvbiwgeyBpZCB9KSA6IHsgaWQgfTtcclxuXHJcbiAgIHJldHVybiBlbnRpdGllc1tpZF0gYXMgRW50aXR5PFR5cGUsIEV4dGVuc2lvbj47XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZXh0ZW5kRW50aXR5ID0gPFR5cGUgZXh0ZW5kcyBzdHJpbmcsIEV4dGVuc2lvbjEsIEV4dGVuc2lvbjI+KFxyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24xPixcclxuICAgZXh0ZW5zaW9uOiBFeHRlbnNpb24yXHJcbikgPT4ge1xyXG4gICByZXR1cm4gT2JqZWN0LmFzc2lnbihlbnRpdHksIGV4dGVuc2lvbikgYXMgRW50aXR5PFxyXG4gICAgICBUeXBlLFxyXG4gICAgICBFeHRlbnNpb24xICYgRXh0ZW5zaW9uMlxyXG4gICA+O1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgVGFuZ2libGVFbnRpdHk8XHJcbiAgIFR5cGUgZXh0ZW5kcyBzdHJpbmcsXHJcbiAgIEV4dGVuc2lvbiBleHRlbmRzIHsgbG9jYXRpb246IFBvaW50M0QgfVxyXG4+ID0gRW50aXR5PFR5cGUsIEV4dGVuc2lvbj47XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUYW5naWJsZUVudGl0eTxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBwb2ludDogRW50aXR5PFR5cGUsIEV4dGVuc2lvbj5cclxuKTogcG9pbnQgaXMgVGFuZ2libGVFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uICYgeyBsb2NhdGlvbjogUG9pbnQzRCB9PiB7XHJcbiAgIHJldHVybiBcImxvY2F0aW9uXCIgaW4gcG9pbnQ7XHJcbn1cclxuIiwiY29uc3QgZ2V0SW1hZ2VGcm9tSWQgPSAoaWQ6IHN0cmluZyk6IEhUTUxJbWFnZUVsZW1lbnQgPT5cclxuICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpIGFzIEhUTUxJbWFnZUVsZW1lbnQ7XHJcblxyXG5leHBvcnQgY29uc3QgZW50aXRpZXMgPSB7XHJcbiAgIHBsYXllcjoge1xyXG4gICAgICBpZDogXCJwbGF5ZXJcIiBhcyBcInBsYXllclwiLFxyXG4gICAgICBzcHJpdGU6IFtcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBpbWFnZTogZ2V0SW1hZ2VGcm9tSWQoXCJyZXNvdXJjZS1wbGF5ZXIwXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDIsXHJcbiAgICAgICAgICAgIHk6IDMsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfSxcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBpbWFnZTogZ2V0SW1hZ2VGcm9tSWQoXCJyZXNvdXJjZS1wbGF5ZXIxXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDIsXHJcbiAgICAgICAgICAgIHk6IDMsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgIH0sXHJcbiAgIC8vIEJldHRlciB3YXkgdG8gaGFuZGxlIHRpbGVzL3RpbGVzZXRzP1xyXG4gICB0aWxlczoge1xyXG4gICAgICBncmFzczoge1xyXG4gICAgICAgICBpZDogXCJ0aWxlcy9ncmFzc1wiIGFzIFwidGlsZXMvZ3Jhc3NcIixcclxuICAgICAgICAgc3ByaXRlOiB7XHJcbiAgICAgICAgICAgIGltYWdlOiBnZXRJbWFnZUZyb21JZChcInJlc291cmNlLWZsb29yXCIpLFxyXG4gICAgICAgICAgICB0aWxlU2l6ZTogMTYsXHJcbiAgICAgICAgICAgIHg6IDgsXHJcbiAgICAgICAgICAgIHk6IDcsXHJcbiAgICAgICAgICAgIHdpZHRoOiAxLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDFcclxuICAgICAgICAgfSxcclxuICAgICAgICAgY29sbGlzaW9uOiBmYWxzZVxyXG4gICAgICB9LFxyXG4gICAgICB3YWxsOiB7XHJcbiAgICAgICAgIGlkOiBcInRpbGVzL3dhbGxcIiBhcyBcInRpbGVzL3dhbGxcIixcclxuICAgICAgICAgc3ByaXRlOiB7XHJcbiAgICAgICAgICAgIGltYWdlOiBnZXRJbWFnZUZyb21JZChcInJlc291cmNlLXdhbGxcIiksXHJcbiAgICAgICAgICAgIHRpbGVTaXplOiAxNixcclxuICAgICAgICAgICAgeDogMyxcclxuICAgICAgICAgICAgeTogMyxcclxuICAgICAgICAgICAgd2lkdGg6IDEsXHJcbiAgICAgICAgICAgIGhlaWdodDogMVxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICBjb2xsaXNpb246IHRydWVcclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbWFwID0gW1xyXG4gICBbXHJcbiAgICAgIFwiIyMjIyMjIyMjIyMjIyMjI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4uLi4uLi4uLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4jIyMjIyMuLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uIy4uLi4jLi4uLiNcIixcclxuICAgICAgXCIjLi4uLiMuLi4uIy4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4jLi4uLiMuLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uIyMuIyMjLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIy4uLi4uLi4uLi4uLi4uI1wiLFxyXG4gICAgICBcIiMuLi4uLi4uLi4uLi4uLiNcIixcclxuICAgICAgXCIjLi4uLi4uLi4uLi4uLi4jXCIsXHJcbiAgICAgIFwiIyMjIyMjIyMjIyMjIyMjI1wiXHJcbiAgIF0sXHJcbiAgIFtcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICBAICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCIsXHJcbiAgICAgIFwiICAgICAgICAgICAgICAgIFwiLFxyXG4gICAgICBcIiAgICAgICAgICAgICAgICBcIixcclxuICAgICAgXCIgICAgICAgICAgICAgICAgXCJcclxuICAgXVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHRpbGVzOiB7XHJcbiAgIFtrZXk6IHN0cmluZ106IHN0cmluZztcclxufSA9IHtcclxuICAgXCIjXCI6IGVudGl0aWVzLnRpbGVzLndhbGwuaWQsXHJcbiAgIFwiLlwiOiBlbnRpdGllcy50aWxlcy5ncmFzcy5pZCxcclxuICAgXCJAXCI6IGVudGl0aWVzLnBsYXllci5pZFxyXG59O1xyXG4iLCJpbXBvcnQgKiBhcyBjb25maWcgZnJvbSBcIi4vZ2FtZS5jb25maWdcIjtcclxuaW1wb3J0IHsgY3JlYXRlU2NlbmUsIGFkZENoaWxkIH0gZnJvbSBcIi4vc2NlbmVcIjtcclxuaW1wb3J0IHsgY3JlYXRlU3ByaXRlLCBTcHJpdGVFbnRpdHksIFNwcml0ZSB9IGZyb20gXCIuL3Nwcml0ZVwiO1xyXG5pbXBvcnQgeyBQb2ludDNEIH0gZnJvbSBcIi4vZ2VvbWV0cnlcIjtcclxuaW1wb3J0IHsgZXh0ZW5kRW50aXR5LCBFbnRpdHkgfSBmcm9tIFwiLi9lbnRpdHlcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBzY2VuZSA9IGNyZWF0ZVNjZW5lKCk7XHJcblxyXG5leHBvcnQgY29uc3QgcGxheWVyQ2FtZXJhID0ge1xyXG4gICBzY2VuZTogc2NlbmUsXHJcbiAgIHRpbGVTaXplOiA0OCxcclxuICAgeDogMCxcclxuICAgeTogMCxcclxuICAgd2lkdGg6IDEyLFxyXG4gICBoZWlnaHQ6IDEyLFxyXG4gICBmb2N1czoge1xyXG4gICAgICB3aWR0aDogNixcclxuICAgICAgaGVpZ2h0OiA2XHJcbiAgIH1cclxufTtcclxuXHJcbmNvbnN0IHRpbGVFbnRpdGllczogeyBbTiBpbiBzdHJpbmddOiBTcHJpdGVFbnRpdHk8Tj4gfSA9ICgoXHJcbiAgIHRpbGVzOiB7IFtOIGluIHN0cmluZ106IEVudGl0eTxOLCB7IHNwcml0ZTogU3ByaXRlIH0+IH1cclxuKSA9PiB7XHJcbiAgIGNvbnN0IGVudGl0aWVzID0ge30gYXMgeyBbTiBpbiBzdHJpbmddOiBTcHJpdGVFbnRpdHk8Tj4gfTtcclxuXHJcbiAgIGZvciAoY29uc3QgbmFtZSBpbiB0aWxlcykge1xyXG4gICAgICBjb25zdCBlbnRpdHkgPSBjcmVhdGVTcHJpdGUodGlsZXNbbmFtZV0pO1xyXG5cclxuICAgICAgaWYgKGlzQ29sbGlkYWJsZSh0aWxlc1tuYW1lXSkpIHtcclxuICAgICAgICAgKGVudGl0eSBhcyBhbnkpLmNvbGxpc2lvbiA9ICh0aWxlc1tuYW1lXSBhcyBhbnkpLmNvbGxpc2lvbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZW50aXRpZXNbZW50aXR5LmlkXSA9IGVudGl0eTtcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIGVudGl0aWVzO1xyXG59KShjb25maWcuZW50aXRpZXMudGlsZXMpO1xyXG5cclxuY29uc3QgYWRkVGlsZSA9IChuYW1lOiBzdHJpbmcsIGxvY2F0aW9uOiBQb2ludDNEKSA9PiB7XHJcbiAgIHJldHVybiBleHRlbmRFbnRpdHkoYWRkQ2hpbGQoc2NlbmUucm9vdCwgdGlsZUVudGl0aWVzW25hbWVdKS5lbnRpdHksIHtcclxuICAgICAgbG9jYXRpb25cclxuICAgfSk7XHJcbn07XHJcblxyXG50aWxlRW50aXRpZXMucGxheWVyID0gY3JlYXRlU3ByaXRlKGNvbmZpZy5lbnRpdGllcy5wbGF5ZXIpO1xyXG5cclxubGV0IHBsYXllcjogRW50aXR5PFwicGxheWVyXCIsIHsgbG9jYXRpb246IFBvaW50M0QgfT4gPSBudWxsIGFzIGFueTtcclxuXHJcbmZ1bmN0aW9uIGlzQ29sbGlkYWJsZTxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24+XHJcbik6IGVudGl0eSBpcyBFbnRpdHk8VHlwZSwgRXh0ZW5zaW9uICYgeyBjb2xsaXNpb246IGJvb2xlYW4gfT4ge1xyXG4gICByZXR1cm4gXCJjb2xsaXNpb25cIiBpbiBlbnRpdHk7XHJcbn1cclxuXHJcbmNvbnN0IGNvbGxpc2lvbk1hcDogYm9vbGVhbltdW10gPSBbXTtcclxuXHJcbmZvciAobGV0IHogPSAwOyB6IDwgY29uZmlnLm1hcC5sZW5ndGg7IHorKykge1xyXG4gICBmb3IgKGxldCB5ID0gMDsgeSA8IGNvbmZpZy5tYXBbel0ubGVuZ3RoOyB5KyspIHtcclxuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBjb25maWcubWFwW3pdW3ldLmxlbmd0aDsgeCsrKSB7XHJcbiAgICAgICAgIGNvbnN0IG5hbWUgPSBjb25maWcudGlsZXNbY29uZmlnLm1hcFt6XVt5XVt4XV07XHJcblxyXG4gICAgICAgICBjb25zdCBlbnRpdHkgPSBhZGRUaWxlKG5hbWUsIHtcclxuICAgICAgICAgICAgeCxcclxuICAgICAgICAgICAgeSxcclxuICAgICAgICAgICAgelxyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIGlmIChpc0NvbGxpZGFibGUoZW50aXR5KSkge1xyXG4gICAgICAgICAgICBpZiAoIWNvbGxpc2lvbk1hcFt4XSkge1xyXG4gICAgICAgICAgICAgICBjb2xsaXNpb25NYXBbeF0gPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb2xsaXNpb25NYXBbeF1beV0gPSBlbnRpdHkuY29sbGlzaW9uO1xyXG4gICAgICAgICB9XHJcblxyXG4gICAgICAgICBpZiAobmFtZSA9PT0gXCJwbGF5ZXJcIikge1xyXG4gICAgICAgICAgICBwbGF5ZXIgPSBlbnRpdHkgYXMgYW55O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG59XHJcblxyXG5wbGF5ZXJDYW1lcmEueCA9IE1hdGguZmxvb3IocGxheWVyLmxvY2F0aW9uLnggLSBwbGF5ZXJDYW1lcmEud2lkdGggLyAyKTtcclxucGxheWVyQ2FtZXJhLnkgPSBNYXRoLmZsb29yKHBsYXllci5sb2NhdGlvbi55IC0gcGxheWVyQ2FtZXJhLmhlaWdodCAvIDIpO1xyXG5cclxuZXhwb3J0IGVudW0gS2V5TWFwIHtcclxuICAgXCJsZWZ0XCIgPSAzNyxcclxuICAgXCJ1cFwiID0gMzgsXHJcbiAgIFwicmlnaHRcIiA9IDM5LFxyXG4gICBcImRvd25cIiA9IDQwXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBoYW5kbGVJbnB1dCA9IChrZXlzUHJlc3NlZDogeyBba2V5OiBudW1iZXJdOiBib29sZWFuIH0pID0+IHtcclxuICAgbGV0IHR1cm5UYWtlbiA9IGZhbHNlO1xyXG4gICBsZXQgdmVjTW92ZW1lbnQ6IFtudW1iZXIsIG51bWJlcl0gPSBbMCwgMF07XHJcblxyXG4gICBjb25zdCBjb2xsaXNpb25BdCA9IChyZWxYOiBudW1iZXIsIHJlbFk6IG51bWJlcikgPT4ge1xyXG4gICAgICBjb25zdCBuZXdYID0gcGxheWVyLmxvY2F0aW9uLnggKyByZWxYO1xyXG4gICAgICBjb25zdCBuZXdZID0gcGxheWVyLmxvY2F0aW9uLnkgKyByZWxZO1xyXG4gICAgICByZXR1cm4gY29sbGlzaW9uTWFwW25ld1hdICYmIGNvbGxpc2lvbk1hcFtuZXdYXVtuZXdZXTtcclxuICAgfTtcclxuXHJcbiAgIGlmIChrZXlzUHJlc3NlZFtLZXlNYXAubGVmdF0gJiYgIWNvbGxpc2lvbkF0KC0xLCAwKSkgdmVjTW92ZW1lbnRbMF0tLTtcclxuICAgaWYgKGtleXNQcmVzc2VkW0tleU1hcC51cF0gJiYgIWNvbGxpc2lvbkF0KDAsIC0xKSkgdmVjTW92ZW1lbnRbMV0tLTtcclxuICAgaWYgKGtleXNQcmVzc2VkW0tleU1hcC5yaWdodF0gJiYgIWNvbGxpc2lvbkF0KDEsIDApKSB2ZWNNb3ZlbWVudFswXSsrO1xyXG4gICBpZiAoa2V5c1ByZXNzZWRbS2V5TWFwLmRvd25dICYmICFjb2xsaXNpb25BdCgwLCAxKSkgdmVjTW92ZW1lbnRbMV0rKztcclxuXHJcbiAgIC8vIE5vIGRpYWdvbmFsIG1vdmVtZW50XHJcbiAgIGlmIChNYXRoLmFicyh2ZWNNb3ZlbWVudFswXSkgKyBNYXRoLmFicyh2ZWNNb3ZlbWVudFsxXSkgPT09IDEpIHtcclxuICAgICAgcGxheWVyLmxvY2F0aW9uLnggKz0gdmVjTW92ZW1lbnRbMF07XHJcbiAgICAgIHBsYXllci5sb2NhdGlvbi55ICs9IHZlY01vdmVtZW50WzFdO1xyXG5cclxuICAgICAgY29uc3QgY2FtZXJhTWFyZ2luWCA9IE1hdGguZmxvb3IoXHJcbiAgICAgICAgIChwbGF5ZXJDYW1lcmEud2lkdGggLSBwbGF5ZXJDYW1lcmEuZm9jdXMud2lkdGgpIC8gMlxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBjYW1lcmFNYXJnaW5ZID0gTWF0aC5mbG9vcihcclxuICAgICAgICAgKHBsYXllckNhbWVyYS5oZWlnaHQgLSBwbGF5ZXJDYW1lcmEuZm9jdXMuaGVpZ2h0KSAvIDJcclxuICAgICAgKTtcclxuICAgICAgaWYgKFxyXG4gICAgICAgICBwbGF5ZXIubG9jYXRpb24ueCA+PVxyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEuZm9jdXMud2lkdGggKyBwbGF5ZXJDYW1lcmEueCArIGNhbWVyYU1hcmdpblhcclxuICAgICAgKSB7XHJcbiAgICAgICAgIHBsYXllckNhbWVyYS54ID1cclxuICAgICAgICAgICAgcGxheWVyLmxvY2F0aW9uLnggKyAxIC0gcGxheWVyQ2FtZXJhLmZvY3VzLndpZHRoIC0gY2FtZXJhTWFyZ2luWDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoXHJcbiAgICAgICAgIHBsYXllci5sb2NhdGlvbi55ID49XHJcbiAgICAgICAgIHBsYXllckNhbWVyYS5mb2N1cy5oZWlnaHQgKyBwbGF5ZXJDYW1lcmEueSArIGNhbWVyYU1hcmdpbllcclxuICAgICAgKSB7XHJcbiAgICAgICAgIHBsYXllckNhbWVyYS55ID1cclxuICAgICAgICAgICAgcGxheWVyLmxvY2F0aW9uLnkgKyAxIC0gcGxheWVyQ2FtZXJhLmZvY3VzLmhlaWdodCAtIGNhbWVyYU1hcmdpblk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBsYXllci5sb2NhdGlvbi54IDwgcGxheWVyQ2FtZXJhLnggKyBjYW1lcmFNYXJnaW5YKSB7XHJcbiAgICAgICAgIHBsYXllckNhbWVyYS54ID0gcGxheWVyLmxvY2F0aW9uLnggLSBjYW1lcmFNYXJnaW5YO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChwbGF5ZXIubG9jYXRpb24ueSA8IHBsYXllckNhbWVyYS55ICsgY2FtZXJhTWFyZ2luWSkge1xyXG4gICAgICAgICBwbGF5ZXJDYW1lcmEueSA9IHBsYXllci5sb2NhdGlvbi55IC0gY2FtZXJhTWFyZ2luWTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdHVyblRha2VuID0gdHJ1ZTtcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIHR1cm5UYWtlbjtcclxufTtcclxuIiwiZXhwb3J0IGludGVyZmFjZSBQb2ludCB7XHJcbiAgIHg6IG51bWJlcjtcclxuICAgeTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBvaW50M0QgZXh0ZW5kcyBQb2ludCB7XHJcbiAgIHo6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZWN0YW5nbGUgZXh0ZW5kcyBQb2ludCB7XHJcbiAgIHdpZHRoOiBudW1iZXI7XHJcbiAgIGhlaWdodDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgaXNPdmVybGFwID0gKFxyXG4gICB7XHJcbiAgICAgIHg6IHgxLFxyXG4gICAgICB5OiB5MSxcclxuICAgICAgd2lkdGg6IHcxID0gMCxcclxuICAgICAgaGVpZ2h0OiBoMSA9IDBcclxuICAgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg/OiBudW1iZXI7IGhlaWdodD86IG51bWJlciB9LFxyXG4gICB7XHJcbiAgICAgIHg6IHgyLFxyXG4gICAgICB5OiB5MixcclxuICAgICAgd2lkdGg6IHcyID0gMCxcclxuICAgICAgaGVpZ2h0OiBoMiA9IDBcclxuICAgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgd2lkdGg/OiBudW1iZXI7IGhlaWdodD86IG51bWJlciB9XHJcbikgPT4geDEgPD0geDIgKyB3MiAmJiB4MSArIHcxID49IHgyICYmIHkxIDw9IHkyICsgaDIgJiYgeTEgKyBoMSA+PSB5MjtcclxuIiwiaW1wb3J0IHsgcmVuZGVyLCBDYW1lcmEgfSBmcm9tIFwiLi9yZW5kZXJlclwiO1xyXG5pbXBvcnQgeyBLZXlNYXAsIGhhbmRsZUlucHV0LCBwbGF5ZXJDYW1lcmEgfSBmcm9tIFwiLi9nYW1lXCI7XHJcblxyXG4vLyBTZXR1cFxyXG5cclxuY29uc3QgJGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbmNvbnN0IGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gKCgpID0+IHtcclxuICAgY29uc3QgY29udGV4dCA9ICRjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgaWYgKGNvbnRleHQgPT09IG51bGwpIHRocm93IG5ldyBFcnJvcihcIk5vIGNvbnRleHQhXCIpO1xyXG4gICBlbHNlIHJldHVybiBjb250ZXh0IGFzIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcclxufSkoKTtcclxuXHJcbiRjYW52YXMud2lkdGggPSA1NzY7XHJcbiRjYW52YXMuaGVpZ2h0ID0gNTc2O1xyXG4kY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4kY2FudmFzLnN0eWxlLnRvcCA9IFwiMFwiO1xyXG4kY2FudmFzLnN0eWxlLmxlZnQgPSBcIjBcIjtcclxuJGNhbnZhcy5zdHlsZS5ib3R0b20gPSBcIjBcIjtcclxuJGNhbnZhcy5zdHlsZS5yaWdodCA9IFwiMFwiO1xyXG4kY2FudmFzLnN0eWxlLm1hcmdpbiA9IFwiYXV0b1wiO1xyXG5jdHguaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XHJcblxyXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCRjYW52YXMpO1xyXG5cclxuLy8gSW5wdXRcclxuLy8gVE9ETzogY2xlYW4gdXAgYnVmZmVyaW5nIGNvZGUsIG9wdGltaXplP1xyXG5cclxuY29uc3Qga2V5c0Rvd246IHsgW2tleTogbnVtYmVyXTogYm9vbGVhbiB9ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuY29uc3Qga2V5c1VwOiB0eXBlb2Yga2V5c0Rvd24gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGUgPT4ge1xyXG4gICBpZiAoZS5rZXlDb2RlIGluIEtleU1hcCkge1xyXG4gICAgICBrZXlzRG93bltlLmtleUNvZGVdID0gdHJ1ZTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICB9XHJcbn0pO1xyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGUgPT4ge1xyXG4gICBpZiAoZS5rZXlDb2RlIGluIEtleU1hcCkge1xyXG4gICAgICBrZXlzVXBbZS5rZXlDb2RlXSA9IHRydWU7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgfVxyXG59KTtcclxuXHJcbmxldCBwcmV2SW5wdXQgPSAwO1xyXG5cclxuY29uc3QgaW5wdXQgPSAoKSA9PiB7XHJcbiAgIGNvbnN0IGRlbHRhID0gdGltZS5jdXJUaW1lIC0gcHJldklucHV0O1xyXG5cclxuICAgbGV0IGtleVByZXNzZWQgPSBmYWxzZTtcclxuXHJcbiAgIGZvciAobGV0IGtleUNvZGUgaW4gS2V5TWFwKSB7XHJcbiAgICAgIGlmICghaXNOYU4oTnVtYmVyKGtleUNvZGUpKSkge1xyXG4gICAgICAgICBpZiAoZGVsdGEgPCB0aW1lLmFuaW1SZXNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgIGtleXNEb3duW2tleUNvZGVdID0ga2V5c1VwW2tleUNvZGVdID8gZmFsc2UgOiBrZXlzRG93bltrZXlDb2RlXTtcclxuICAgICAgICAgICAga2V5c1VwW2tleUNvZGVdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGtleVByZXNzZWQgPSBmYWxzZTtcclxuICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAga2V5UHJlc3NlZCA9IGtleXNEb3duW2tleUNvZGVdIHx8IGtleVByZXNzZWQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcblxyXG4gICBpZiAoa2V5UHJlc3NlZCkge1xyXG4gICAgICBjb25zdCB0dXJuVGFrZW4gPSBoYW5kbGVJbnB1dChcclxuICAgICAgICAgT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCBrZXlzRG93bilcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICh0dXJuVGFrZW4pIHByZXZJbnB1dCA9IHRpbWUuY3VyVGltZTtcclxuICAgfVxyXG59O1xyXG5cclxuLy8gRlBTIENvdW50ZXJcclxuXHJcbmRlY2xhcmUgY2xhc3MgU3RhdHMge1xyXG4gICBkb206IE5vZGU7XHJcbiAgIHVwZGF0ZTogKCkgPT4gdm9pZDtcclxufVxyXG5cclxuY29uc3Qgc3RhdHMgPSBuZXcgU3RhdHMoKTtcclxuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzdGF0cy5kb20pO1xyXG5cclxuLy8gUmVuZGVyIExvb3BcclxuXHJcbmNvbnN0IHRpbWUgPSB7XHJcbiAgIHN0YXJ0OiAwLFxyXG4gICBwcmV2VGltZTogMCxcclxuICAgY3VyVGltZTogcGVyZm9ybWFuY2Uubm93KCksXHJcbiAgIGFuaW1Db3VudGVyOiAwLFxyXG4gICBhbmltU3RhdGU6IDAsXHJcbiAgIGFuaW1SZXNvbHV0aW9uOiA1MDBcclxufTtcclxuXHJcbmNvbnN0IGNhbWVyYSA9IChjYW1lcmEgPT4ge1xyXG4gICBjYW1lcmEuY2FudmFzID0gJGNhbnZhcztcclxuICAgcmV0dXJuIGNhbWVyYTtcclxufSkoKHBsYXllckNhbWVyYSBhcyBhbnkpIGFzIENhbWVyYSk7XHJcblxyXG5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gbG9vcCgpIHtcclxuICAgaWYgKHRpbWUuc3RhcnQgPT09IDApIHRpbWUuc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgdGltZS5jdXJUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgIGNvbnN0IGRlbHRhVGltZSA9IHRpbWUuY3VyVGltZSAtIHRpbWUucHJldlRpbWU7XHJcblxyXG4gICB0aW1lLmFuaW1Db3VudGVyICs9IGRlbHRhVGltZTtcclxuICAgdGltZS5hbmltU3RhdGUgPSBNYXRoLmZsb29yKHRpbWUuYW5pbUNvdW50ZXIgLyB0aW1lLmFuaW1SZXNvbHV0aW9uKTtcclxuXHJcbiAgIGlucHV0KCk7XHJcblxyXG4gICBpZiAodGltZS5wcmV2VGltZSAhPT0gMCkge1xyXG4gICAgICByZW5kZXIoe1xyXG4gICAgICAgICBjYW1lcmEsXHJcbiAgICAgICAgIGFuaW1TdGF0ZTogdGltZS5hbmltU3RhdGVcclxuICAgICAgfSk7XHJcbiAgIH1cclxuXHJcbiAgIHN0YXRzLnVwZGF0ZSgpO1xyXG4gICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XHJcbiAgIHRpbWUucHJldlRpbWUgPSB0aW1lLmN1clRpbWU7XHJcbn0pO1xyXG4iLCJpbXBvcnQgeyBTcHJpdGUsIFNwcml0ZUVudGl0eSwgaXNTcHJpdGVFbnRpdHkgfSBmcm9tIFwiLi9zcHJpdGVcIjtcclxuaW1wb3J0IHsgU2NlbmUgfSBmcm9tIFwiLi9zY2VuZVwiO1xyXG5pbXBvcnQgeyBSZWN0YW5nbGUsIGlzT3ZlcmxhcCwgUG9pbnQzRCB9IGZyb20gXCIuL2dlb21ldHJ5XCI7XHJcbmltcG9ydCB7IGlzVGFuZ2libGVFbnRpdHksIEVudGl0eSB9IGZyb20gXCIuL2VudGl0eVwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYW1lcmEgZXh0ZW5kcyBSZWN0YW5nbGUge1xyXG4gICBzY2VuZTogU2NlbmU7XHJcbiAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgIHRpbGVTaXplOiBudW1iZXI7XHJcbn1cclxuXHJcbmNvbnN0IGRyYXdTcHJpdGUgPSAoXHJcbiAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxyXG4gICBzcHJpdGU6IFNwcml0ZSxcclxuICAgdGlsZVNpemU6IG51bWJlcixcclxuICAgZHN0WDogbnVtYmVyLFxyXG4gICBkc3RZOiBudW1iZXJcclxuKSA9PiB7XHJcbiAgIGN0eC5kcmF3SW1hZ2UoXHJcbiAgICAgIHNwcml0ZS5pbWFnZSxcclxuICAgICAgc3ByaXRlLnggKiBzcHJpdGUudGlsZVNpemUsXHJcbiAgICAgIHNwcml0ZS55ICogc3ByaXRlLnRpbGVTaXplLFxyXG4gICAgICBzcHJpdGUud2lkdGggKiBzcHJpdGUudGlsZVNpemUsXHJcbiAgICAgIHNwcml0ZS5oZWlnaHQgKiBzcHJpdGUudGlsZVNpemUsXHJcbiAgICAgIGRzdFggKiB0aWxlU2l6ZSxcclxuICAgICAgZHN0WSAqIHRpbGVTaXplLFxyXG4gICAgICBzcHJpdGUud2lkdGggKiB0aWxlU2l6ZSxcclxuICAgICAgc3ByaXRlLmhlaWdodCAqIHRpbGVTaXplXHJcbiAgICk7XHJcbn07XHJcblxyXG5jb25zdCBkcmF3RW50aXR5ID0gKFxyXG4gICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcclxuICAgZW50aXR5OiBTcHJpdGVFbnRpdHk8c3RyaW5nPixcclxuICAgYW5pbWF0aW9uOiBudW1iZXIsXHJcbiAgIHRpbGVTaXplOiBudW1iZXIsXHJcbiAgIGRzdFg6IG51bWJlcixcclxuICAgZHN0WTogbnVtYmVyXHJcbikgPT4ge1xyXG4gICBjb25zdCBzcHJpdGUgPSBBcnJheS5pc0FycmF5KGVudGl0eS5zcHJpdGUpXHJcbiAgICAgID8gZW50aXR5LnNwcml0ZVthbmltYXRpb24gJSBlbnRpdHkuc3ByaXRlLmxlbmd0aF1cclxuICAgICAgOiBlbnRpdHkuc3ByaXRlO1xyXG4gICBkcmF3U3ByaXRlKGN0eCwgc3ByaXRlLCB0aWxlU2l6ZSwgZHN0WCwgZHN0WSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVuZGVyID0gKHtcclxuICAgY2FtZXJhLFxyXG4gICBhbmltU3RhdGVcclxufToge1xyXG4gICBjYW1lcmE6IENhbWVyYTtcclxuICAgYW5pbVN0YXRlOiBudW1iZXI7XHJcbn0pID0+IHtcclxuICAgY29uc3QgY3R4ID0gY2FtZXJhLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG4gICBpZiAoY3R4ICE9PSBudWxsKSB7XHJcbiAgICAgIGN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW1lcmEuY2FudmFzLndpZHRoLCBjYW1lcmEuY2FudmFzLmhlaWdodCk7XHJcblxyXG4gICAgICBjb25zdCBzcHJpdGVzOiB7XHJcbiAgICAgICAgIFtrZXk6IG51bWJlcl06IEVudGl0eTxcclxuICAgICAgICAgICAgc3RyaW5nLFxyXG4gICAgICAgICAgICB7IHNwcml0ZTogU3ByaXRlIHwgU3ByaXRlW107IGxvY2F0aW9uOiBQb2ludDNEIH1cclxuICAgICAgICAgPltdO1xyXG4gICAgICB9ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuXHJcbiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBjYW1lcmEuc2NlbmUubm9kZXMpIHtcclxuICAgICAgICAgY29uc3QgZW50aXR5ID0gbm9kZS5lbnRpdHk7XHJcbiAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgaXNTcHJpdGVFbnRpdHkoZW50aXR5KSAmJlxyXG4gICAgICAgICAgICBpc1RhbmdpYmxlRW50aXR5KGVudGl0eSkgJiZcclxuICAgICAgICAgICAgaXNPdmVybGFwKGNhbWVyYSwgZW50aXR5LmxvY2F0aW9uKVxyXG4gICAgICAgICApIHtcclxuICAgICAgICAgICAgc3ByaXRlc1tlbnRpdHkubG9jYXRpb24uel0gPSBzcHJpdGVzW2VudGl0eS5sb2NhdGlvbi56XSB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgIHNwcml0ZXNbZW50aXR5LmxvY2F0aW9uLnpdLnB1c2goZW50aXR5KTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHogaW4gc3ByaXRlcykge1xyXG4gICAgICAgICBmb3IgKGNvbnN0IHNwcml0ZSBvZiBzcHJpdGVzW3pdKSB7XHJcbiAgICAgICAgICAgIGRyYXdFbnRpdHkoXHJcbiAgICAgICAgICAgICAgIGN0eCxcclxuICAgICAgICAgICAgICAgc3ByaXRlLFxyXG4gICAgICAgICAgICAgICBhbmltU3RhdGUsXHJcbiAgICAgICAgICAgICAgIGNhbWVyYS50aWxlU2l6ZSxcclxuICAgICAgICAgICAgICAgc3ByaXRlLmxvY2F0aW9uLnggLSBjYW1lcmEueCxcclxuICAgICAgICAgICAgICAgc3ByaXRlLmxvY2F0aW9uLnkgLSBjYW1lcmEueVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG59O1xyXG4iLCJpbXBvcnQgeyBFbnRpdHksIGNyZWF0ZUVudGl0eSB9IGZyb20gXCIuL2VudGl0eVwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTY2VuZSB7XHJcbiAgIG5vZGVzOiBOb2RlPHN0cmluZywge30+W107XHJcbiAgIHJvb3Q6IE5vZGU8c3RyaW5nLCB7fT47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVTY2VuZSA9ICgpID0+IHtcclxuICAgY29uc3Qgc2NlbmUgPSB7XHJcbiAgICAgIG5vZGVzOiBbXSxcclxuICAgICAgcm9vdDoge1xyXG4gICAgICAgICBzY2VuZTogbnVsbCBhcyBTY2VuZSB8IG51bGwsXHJcbiAgICAgICAgIHBhcmVudDogbnVsbCxcclxuICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICBlbnRpdHk6IGNyZWF0ZUVudGl0eShcInNjZW5lXCIpXHJcbiAgICAgIH1cclxuICAgfTtcclxuXHJcbiAgIHNjZW5lLnJvb3Quc2NlbmUgPSBzY2VuZSBhcyBTY2VuZTtcclxuXHJcbiAgIHJldHVybiBzY2VuZSBhcyBTY2VuZTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGRDaGlsZCA9IDxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+KFxyXG4gICBub2RlOiBOb2RlPHN0cmluZywge30+LFxyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24+XHJcbikgPT4ge1xyXG4gICBjb25zdCBjaGlsZDogTm9kZTxUeXBlLCBFeHRlbnNpb24+ID0ge1xyXG4gICAgICBzY2VuZTogbm9kZS5zY2VuZSxcclxuICAgICAgcGFyZW50OiBub2RlLFxyXG4gICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgIGVudGl0eTogT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCBlbnRpdHkpXHJcbiAgIH07XHJcblxyXG4gICBub2RlLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xyXG4gICBub2RlLnNjZW5lLm5vZGVzLnB1c2goY2hpbGQpO1xyXG5cclxuICAgcmV0dXJuIGNoaWxkO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlbW92ZUNoaWxkID0gPFR5cGUgZXh0ZW5kcyBzdHJpbmcsIEV4dGVuc2lvbj4oXHJcbiAgIG5vZGU6IE5vZGU8VHlwZSwgRXh0ZW5zaW9uPlxyXG4pID0+IHtcclxuICAgaWYgKG5vZGUucGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgY29uc3QgcGFyZW50SW5kZXggPSBub2RlLnBhcmVudC5jaGlsZHJlbi5pbmRleE9mKG5vZGUpO1xyXG4gICAgICBub2RlLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UocGFyZW50SW5kZXgsIDEpO1xyXG5cclxuICAgICAgY29uc3Qgc2NlbmVJbmRleCA9IG5vZGUuc2NlbmUubm9kZXMuaW5kZXhPZihub2RlKTtcclxuICAgICAgbm9kZS5zY2VuZS5ub2Rlcy5zcGxpY2Uoc2NlbmVJbmRleCwgMSk7XHJcbiAgIH1cclxufTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTm9kZTxUeXBlIGV4dGVuZHMgc3RyaW5nLCBFeHRlbnNpb24+IHtcclxuICAgc2NlbmU6IFNjZW5lO1xyXG4gICBwYXJlbnQ6IE5vZGU8c3RyaW5nLCB7fT4gfCBudWxsO1xyXG4gICBjaGlsZHJlbjogTm9kZTxzdHJpbmcsIHt9PltdO1xyXG4gICBlbnRpdHk6IEVudGl0eTxUeXBlLCBFeHRlbnNpb24+O1xyXG59XHJcbiIsImltcG9ydCB7IEVudGl0eSwgY3JlYXRlRW50aXR5IH0gZnJvbSBcIi4vZW50aXR5XCI7XHJcbmltcG9ydCB7IFJlY3RhbmdsZSB9IGZyb20gXCIuL2dlb21ldHJ5XCI7XHJcblxyXG5leHBvcnQgdHlwZSBJbWFnZSA9IEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MQ2FudmFzRWxlbWVudCB8IEltYWdlQml0bWFwO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTcHJpdGUgZXh0ZW5kcyBSZWN0YW5nbGUge1xyXG4gICBpbWFnZTogSW1hZ2U7XHJcbiAgIHRpbGVTaXplOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFNwcml0ZUVudGl0eTxUeXBlIGV4dGVuZHMgc3RyaW5nPiA9IEVudGl0eTxcclxuICAgVHlwZSxcclxuICAge1xyXG4gICAgICBzcHJpdGU6IFNwcml0ZSB8IFNwcml0ZVtdO1xyXG4gICB9XHJcbj47XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNTcHJpdGVFbnRpdHk8VHlwZSBleHRlbmRzIHN0cmluZywgRXh0ZW5zaW9uPihcclxuICAgZW50aXR5OiBFbnRpdHk8c3RyaW5nLCBFeHRlbnNpb24+XHJcbik6IGVudGl0eSBpcyBFbnRpdHk8XHJcbiAgIFR5cGUsXHJcbiAgIEV4dGVuc2lvbiAmIHtcclxuICAgICAgc3ByaXRlOiBTcHJpdGUgfCBTcHJpdGVbXTtcclxuICAgfVxyXG4+IHtcclxuICAgcmV0dXJuIFwic3ByaXRlXCIgaW4gZW50aXR5O1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlU3ByaXRlID0gPFR5cGUgZXh0ZW5kcyBzdHJpbmc+KHtcclxuICAgaWQsXHJcbiAgIHNwcml0ZVxyXG59OiB7XHJcbiAgIGlkOiBUeXBlO1xyXG4gICBzcHJpdGU6IFNwcml0ZSB8IFNwcml0ZVtdO1xyXG59KSA9PiB7XHJcbiAgIGxldCBzcHJpdGVDb3B5ID0gbnVsbCBhcyBhbnk7XHJcblxyXG4gICBpZiAoQXJyYXkuaXNBcnJheShzcHJpdGUpKSB7XHJcbiAgICAgIHNwcml0ZUNvcHkgPSBzcHJpdGUuc2xpY2UoKTtcclxuICAgICAgZm9yIChjb25zdCBpIGluIHNwcml0ZSkge1xyXG4gICAgICAgICBzcHJpdGVbaV0gPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCkgYXMge30sIHNwcml0ZVtpXSk7XHJcbiAgICAgIH1cclxuICAgfSBlbHNlIHtcclxuICAgICAgc3ByaXRlQ29weSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShudWxsKSBhcyB7fSwgc3ByaXRlKTtcclxuICAgfVxyXG5cclxuICAgcmV0dXJuIGNyZWF0ZUVudGl0eShpZCwge1xyXG4gICAgICBzcHJpdGU6IHNwcml0ZUNvcHlcclxuICAgfSkgYXMgU3ByaXRlRW50aXR5PFR5cGU+O1xyXG59O1xyXG4iXX0=
